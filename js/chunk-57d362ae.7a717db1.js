(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57d362ae"],{"29c2":function(t,e,a){"use strict";a.d(e,"c",(function(){return i})),a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return o}));var s=a("41cb");function i(t){var e={type:"bbs"};return t&&(e=Object.assign(e,t)),Object(s["b"])().get("/api/cms/posts",{params:e})}function n(t){return Object(s["b"])().get("/api/cms/post/".concat(t))}function o(t){return 11}},"2f56":function(t,e,a){},"31a9":function(t,e,a){"use strict";a("a5b9")},"46a7":function(t,e,a){},"6e7a":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"v-feedback"},[t.id?[a("div",{staticClass:"m-single-feedback-container"},[a("feedback-item",{attrs:{mode:"single","feedback-id":t.id}})],1)]:[a("publish-feedback",{on:{update:t.handleFeedbackUpdate}}),a("listbox",{attrs:{data:t.data,total:t.total,pages:t.pages,per:t.per,page:t.page},on:{appendPage:t.appendPage,changePage:t.changePage}},[a("template",{slot:"filter"},[a("clientBy",{attrs:{type:t.client},on:{filter:t.filter}}),a("markBy",{on:{filter:t.filter}}),a("orderBy",{on:{filter:t.filter}})],1),t.data.length?a("div",{staticClass:"m-feedback-list"},[a("ul",{staticClass:"u-list"},t._l(t.data,(function(e,s){return a("li",{key:s,staticClass:"u-item"},[a("feedback-item",{attrs:{data:e,order:t.order}})],1)})),0)]):t._e()],2)]],2)},i=[],n=(a("ac1f"),a("841c"),a("d3b7"),a("99af"),a("d81d"),a("159b"),a("a0dd")),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-publish-feedback"},[a("el-input",{attrs:{type:"textarea",placeholder:"输入反馈建议......","show-word-limit":"",maxlength:5120,rows:4},model:{value:t.post.post_content,callback:function(e){t.$set(t.post,"post_content",e)},expression:"post.post_content"}}),a("div",{staticClass:"u-feedback-actions"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.url,"list-type":"picture-card","on-remove":t.remove,"on-success":t.done,"on-error":t.fail,"on-exceed":t.exceed,limit:t.max,title:"上传图片","with-credentials":"",accept:"image/jpg,image/jpeg,image/gif,image/png,image/bmp"}},[a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),a("div",{staticClass:"u-submit"},[a("el-button",{attrs:{loading:t.processing},on:{click:t.publish}},[t._v("提交")])],1)],1)],1)},c=[],r=a("2909"),l=(a("4de4"),a("fb6a"),a("65c2")),u=a("41cb");function d(t){return Object(u["b"])().post("/api/cms/post",t)}var p=l["__cms"],h=p+"api/cms/upload",f={name:"publishFeedback",data:function(){return{imgs:[],url:h,max:8,post:{ID:"",post_status:"publish",post_type:"feedback",post_title:"",post_subtype:"0",post_meta:{},post_content:"",post_mode:"",original:1,client:"all",lang:"cn",zlp:"",post_excerpt:"",post_banner:"",post_collection:"",comment:0,visible:0,tags:[]},processing:!1}},methods:{done:function(t){this.imgs=[].concat(Object(r["a"])(this.imgs),[t.data[0]])},fail:function(t){try{var e=JSON.parse(t.message);this.$message.error("[".concat(e.code,"]").concat(e.msg))}catch(a){this.$message.error("网络请求异常")}},exceed:function(){this.$message.warning("上传的图片个数最多为".concat(this.max,"个"))},remove:function(t){this.imgs=this.imgs.filter((function(e){var a;return e!==(null===t||void 0===t||null===(a=t.response)||void 0===a?void 0:a.data[0])}))},publish:function(){var t=this;this.post.post_meta=this.imgs,this.processing=!0,this.post.post_excerpt=this.post.post_content.slice(0,200),d(this.post).then((function(e){var a=e.data.data;t.$emit("update",a),t.$message.success("反馈提交成功"),t.post=t.$options.data().post,t.imgs=[]})).catch((function(e){t.$message.error("反馈提交失败")})).finally((function(){t.processing=!1}))}}},g=f,m=(a("e315"),a("2877")),v=Object(m["a"])(g,o,c,!1,null,null,null),b=v.exports,_=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"m-feedback-item"},["single"===t.mode?[s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"u-feedback-single"},[s("div",{staticClass:"u-single-header"},[s("single-header",{attrs:{post:t.post}},[s("span",[t._v("类型：反馈建议")])])],1),s("div",{staticClass:"u-single-content"},[t._v(" "+t._s(t.post.post_content)+" ")]),s("div",{staticClass:"u-single-imgs"},t._l(t.images,(function(e,a){return s("img",{key:e,attrs:{src:e},on:{click:function(e){return t.handlePreview(a)}}})})),0),s("Thx",{staticClass:"m-thx",attrs:{postId:t.feedbackId,postType:"feedback",adminBoxcoinEnable:!1,userBoxcoinEnable:!0}}),s("div",{staticClass:"m-single-comment"},[s("el-divider",{attrs:{"content-position":"left"}},[t._v("评论")]),t.feedbackId?s("Comment",{attrs:{id:t.feedbackId,category:"post"}}):s("el-alert",{attrs:{title:"作者没有开启评论功能",type:"warning","show-icon":""}})],1)],1)]:[s("div",{staticClass:"u-feedback-content"},[s("router-link",{attrs:{tag:"div",to:t._f("postLink")(t.data.ID)}},[t._v(" "+t._s(t.data.post_excerpt)+" ")])],1),s("div",{staticClass:"u-feedback-misc"},[s("img",{staticClass:"u-author-avatar",attrs:{src:t._f("showAvatar")(t.data.author_info.user_avatar),alt:t.data.author_info.display_name}}),s("a",{staticClass:"u-author-name",attrs:{href:t._f("authorLink")(t.data.post_author),target:"_blank"}},[t._v(t._s(t.data.author_info.display_name))]),s("span",{staticClass:"u-feedback-date"},["update"==t.order?s("time",[t._v(t._s(t._f("dateFormat")(t.data.post_modified)))]):s("time",[t._v(t._s(t._f("dateFormat")(t.data.post_date)))])]),s("span",{staticClass:"like",class:{disabled:!t.isLike},attrs:{title:"点赞"},on:{click:t.addLike}},[s("img",{staticClass:"like-icon",attrs:{src:a("0dab"),"svg-inline":""}}),s("span",{staticClass:"like-count"},[t._v(t._s(t.count))])])])]],2)},k=[],w=(a("a9e3"),a("fb92")),C=a("85e4"),x=a("9616"),y=a("29c2"),P=a("23d8"),$=a("9362"),j={name:"feedbackItem",props:{data:{type:Object,default:function(){}},order:{type:String,default:""},mode:{type:String,default:"list"},feedbackId:{type:[String,Number],defalut:0}},data:function(){return{isLike:!0,count:0,post:{},loading:!1}},computed:{images:function(){var t;return(null===(t=this.post)||void 0===t?void 0:t.post_meta)||[]}},watch:{data:{deep:!0,immediate:!0,handler:function(t){t&&(this.count=t.count||0)}},feedbackId:{immediate:!0,handler:function(t){"single"===this.mode&&this.loadPost()}}},filters:{dateFormat:function(t){return Object(w["b"])(new Date(t))},showAvatar:function(t){return Object(C["showAvatar"])(t)},authorLink:function(t){return Object(C["authorLink"])(t)},postLink:function(t){return location.origin+"/feedback/"+t}},methods:{handlePreview:function(t){this.$hevueImgPreview({multiple:!0,nowImgIndex:t,imgList:this.images,controlBar:!1,clickMaskCLose:!0})},addLike:function(){if(this.isLike){var t;if(this.count++,this.isLike)Object(x["b"])("feedback",null===(t=this.data)||void 0===t?void 0:t.ID,"likes");this.isLike=!1}},loadPost:function(){var t=this;this.loading=!0,Object(y["b"])(this.feedbackId,this).then((function(e){t.post=e.data.data})).finally((function(){t.loading=!1}))}},components:{Comment:P["a"],singleHeader:$["a"]}},O=j,z=(a("8d4b"),Object(m["a"])(O,_,k,!1,null,null,null)),M=z.exports,I=a("1647"),L=(a("2ef0"),{name:"Feedback",props:[],data:function(){return{loading:!1,data:[],page:1,total:1,pages:1,per:10,appendMode:!1,search:"",searchType:"title",order:"update",mark:"",client:this.$store.state.client}},computed:{id:function(){return this.$route.params.id},resetParams:function(){return[this.subtype,this.search,this.mark,this.client]},params:function(){var t=this,e={per:this.per,page:~~this.page||1,sticky:1,type:"feedback"},a=["search","order","mark","client"];return a.forEach((function(a){t[a]&&(e[a]=t[a])})),e},target:function(){return Object(C["buildTarget"])()},defaultBanner:function(){return l["__imgPath"]+"image/banner/null.png"},publish_link:function(t){return Object(C["publishLink"])("bbs")}},methods:{loadPosts:function(){var t=this;this.loading=!0,Object(y["c"])(this.params,this).then((function(e){t.appendMode?t.data=t.data.concat(e.data.data.list):t.data=e.data.data.list,t.total=e.data.data.total,t.pages=e.data.data.pages})).finally((function(){t.appendMode=!1,t.loading=!1}))},changePage:function(t){this.appendMode=!1,this.page=t,window.scrollTo(0,0)},appendPage:function(t){this.appendMode=!0,this.page=t},filter:function(t){this.appendMode=!1,this[t["type"]]=t["val"]},showBanner:function(t,e){return t?Object(C["showBanner"])(t):l["__imgPath"]+"image/banner/bbs"+e+".png?v=1"},handleFeedbackUpdate:function(t){this.loadPosts()},loadLike:function(){var t=this,e=this.data.map((function(t){return t.ID}));Object(y["a"])(e).then((function(e){t.data.forEach((function(t){console.log(t)}))}))}},filters:{dateFormat:function(t){return Object(w["a"])(new Date(t))},showAvatar:function(t){return Object(C["showAvatar"])(t)},isHighlight:function(t){return t?"color:".concat(t,";font-weight:600;"):""},showMark:function(t){return I["a"][t]},markcls:function(t){return"u-mark-"+t}},watch:{subtype:function(){this.search=""},params:{deep:!0,immediate:!0,handler:function(t){this.loadPosts()}},"$route.query.page":function(t){this.page=~~t}},created:function(){this.page=~~this.$route.query.page||1},components:{listbox:n["a"],"publish-feedback":b,feedbackItem:M}}),H=L,V=(a("31a9"),Object(m["a"])(H,s,i,!1,null,null,null));e["default"]=V.exports},"735f":function(t,e,a){"use strict";a("2f56")},"76b1":function(t,e,a){},"79f3":function(t,e,a){"use strict";a("76b1")},8423:function(t,e,a){},"8d4b":function(t,e,a){"use strict";a("8423")},9362:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"m-single-header"},[a("div",{staticClass:"m-single-title"},[a("a",{staticClass:"u-title u-sub-block",attrs:{href:t.url,title:t.title}},[t.isOriginal?a("i",{staticClass:"u-original"},[t._v("原创")]):t._e(),a("i",{staticClass:"u-private"},["draft"==t.post.post_status||~~t.post.visible?a("i",{staticClass:"el-icon-lock",staticStyle:{color:"#fb9b24"}}):t._e(),"dustbin"==t.post.post_status?a("i",{staticClass:"el-icon-delete",staticStyle:{color:"#c00"}}):t._e()]),a("span",{staticClass:"u-title-text"},[t._v(t._s(t.title))])])]),a("div",{staticClass:"m-single-info"},[a("div",{staticClass:"u-author u-sub-block"},[a("i",{staticClass:"u-author-icon"},[a("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 16",width:"12",height:"16","aria-hidden":"true",fill:"#444","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[a("path",{attrs:{"fill-rule":"evenodd",d:"M12 14.002a.998.998 0 01-.998.998H1.001A1 1 0 010 13.999V13c0-2.633 4-4 4-4s.229-.409 0-1c-.841-.62-.944-1.59-1-4 .173-2.413 1.867-3 3-3s2.827.586 3 3c-.056 2.41-.159 3.38-1 4-.229.59 0 1 0 1s4 1.367 4 4v1.002z"}})])]),a("a",{staticClass:"u-name",attrs:{href:t.author_link}},[t._v(t._s(t.author_name))])]),t._t("default"),a("span",{staticClass:"u-podate u-sub-block",attrs:{title:"发布日期"}},[a("i",{staticClass:"u-icon-podate"},[a("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"#6a737d",viewBox:"0 0 485.2 485.2","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[a("path",{attrs:{d:"M60.7 75.8V15.2C60.7 6.8 67.4 0 75.8 0 84.2 0 91 6.8 91 15.2v60.7C91 84.2 84.2 91 75.8 91c-8.4 0-15.1-6.8-15.1-15.2zM318.4 91c8.4 0 15.2-6.8 15.2-15.2V15.2c0-8.4-6.8-15.2-15.2-15.2-8.4 0-15.2 6.8-15.2 15.2v60.7c.1 8.3 6.8 15.1 15.2 15.1zM60.7 182h60.7v60.7H60.7zM60.7 272.9h60.7v60.7H60.7zM151.6 182h60.7v60.7h-60.7zM151.6 272.9h60.7v60.7h-60.7z"}}),a("path",{attrs:{d:"M30 361.2v-210h334c.2 70.7.4 141.4.7 212.1 9.8 0 19.6-.1 29.3-.1V93.6c0-18.5-14.5-33.4-32.5-33.4H349v15.2c0 16.7-13.7 30.3-30.5 30.3S288 92.1 288 75.4V60.2H106v15.2c0 16.7-13.7 30.3-30.5 30.3S45 92.1 45 75.4V60.2H32.5c-18 0-32.5 15-32.5 33.4v267.2c0 9.2 3.6 17.5 9.5 23.6 7.8 8.1 18.5 9.3 23 9.8 22.1 2.4 165.3 2.9 361.5 1v-32c-120.5.3-241 .7-361.5 1-.8-1-1.7-2-2.5-3z"}}),a("path",{attrs:{d:"M242.6 182h60.6v60.7h-60.6zM242.6 272.9h60.7v60.7h-60.7z"}})])]),a("time",[t._v(t._s(t.post_date))])]),a("span",{staticClass:"u-modate u-sub-block",attrs:{title:"最后更新"}},[a("i",{staticClass:"u-icon-modate"},[a("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"485.213",height:"485.212",viewBox:"0 0 485.213 485.212",fill:"#555","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[a("path",{attrs:{d:"M60.652 75.816V15.163C60.652 6.781 67.433 0 75.817 0c8.38 0 15.161 6.781 15.161 15.163v60.653c0 8.38-6.781 15.161-15.161 15.161-8.384.001-15.165-6.781-15.165-15.161zm257.772 15.162c8.378 0 15.163-6.781 15.163-15.161V15.163C333.587 6.781 326.802 0 318.424 0c-8.382 0-15.168 6.781-15.168 15.163v60.653c0 8.38 6.786 15.162 15.168 15.162zm166.788 272.928c0 66.996-54.312 121.307-121.303 121.307-66.986 0-121.302-54.311-121.302-121.307 0-66.986 54.315-121.3 121.302-121.3 66.991 0 121.303 54.313 121.303 121.3zm-30.322 0c0-50.161-40.81-90.976-90.98-90.976-50.166 0-90.976 40.814-90.976 90.976 0 50.171 40.81 90.98 90.976 90.98 50.17 0 90.98-40.809 90.98-90.98zM121.305 181.955H60.652v60.651h60.653v-60.651zM60.652 333.584h60.653V272.93H60.652v60.654zm90.977-90.978h60.654v-60.651h-60.654v60.651zm0 90.978h60.654V272.93h-60.654v60.654zM30.328 360.891V151.628H363.91v60.653h30.327V94c0-18.421-14.692-33.349-32.843-33.349h-12.647v15.166c0 16.701-13.596 30.325-30.322 30.325-16.731 0-30.326-13.624-30.326-30.325V60.651H106.14v15.166c0 16.701-13.593 30.325-30.322 30.325-16.733 0-30.327-13.624-30.327-30.325V60.651H32.859C14.707 60.651.001 75.579.001 94v266.892c0 18.36 14.706 33.346 32.858 33.346h179.424v-30.331H32.859c-1.374-.001-2.531-1.42-2.531-3.016zm272.928-118.285v-60.651h-60.648v60.651h60.648zm106.143 121.3h-45.49v-45.49c0-8.377-6.781-15.158-15.163-15.158s-15.159 6.781-15.159 15.158v60.658c0 8.378 6.777 15.163 15.159 15.163h60.653c8.382 0 15.163-6.785 15.163-15.163 0-8.382-6.781-15.168-15.163-15.168z"}})])]),a("time",[t._v(t._s(t.update_date))])]),a("span",{staticClass:"u-views u-sub-block"},[a("i",{staticClass:"el-icon-view"}),t._v(" "+t._s(t.views)+" ")]),t.canEdit?a("a",{staticClass:"u-edit u-sub-block",attrs:{href:t.edit_link}},[a("i",{staticClass:"u-icon-edit el-icon-edit-outline"}),a("span",[t._v("编辑")])]):t._e()],2)])},i=[],n=a("2ef0"),o=a.n(n);a("65c2");function c(t,e="-",a=!0){let s=t.getFullYear(),i=t.getMonth()+1,n=t.getDate(),o=a?`${s}${e}${r(i)}${e}${r(n)}`:`${s}${e}${i}${e}${n}`;return o}function r(t){return t<10?"0"+t:t}var l=c,u=a("85e4"),d=a("c9d2"),p={name:"single-header",props:["post","stat"],data:function(){return{}},computed:{url:function(){return location.href},isOriginal:function(){return!!~~o.a.get(this.post,"original")},title:function(){return o.a.get(this.post,"post_title")||"无标题"},author_link:function(){return Object(u["authorLink"])(this.post.post_author)},author_name:function(){return this.post.author||"匿名"},post_date:function(){return l(new Date(o.a.get(this.post,"post_date")))},update_date:function(){return l(new Date(o.a.get(this.post,"post_modified")))},views:function(){return o.a.get(this.stat,"views")||"-"},edit_link:function(){return Object(u["editLink"])(o.a.get(this.post,"post_type"),o.a.get(this.post,"ID"))},canEdit:function(){return o.a.get(this.post,"post_author")==d["a"].getInfo().uid||d["a"].isEditor()}},methods:{},mounted:function(){}},h=p,f=(a("79f3"),a("2877")),g=Object(f["a"])(h,s,i,!1,null,null,null);e["a"]=g.exports},a0dd:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-archive-box"},[t._t("search-before"),t.$slots.filter?a("div",{staticClass:"m-archive-filter"},[t._t("filter")],2):t._e(),t._t("search-after"),t._t("default"),t.list.length?t._e():a("el-alert",{staticClass:"m-archive-null",attrs:{title:"没有找到相关条目",type:"info",center:"","show-icon":""}}),a("el-button",{staticClass:"m-archive-more",class:{show:t.hasNextPage},attrs:{type:"primary"},on:{click:t.appendPage}},[t._v("加载更多")]),a("el-pagination",{staticClass:"m-archive-pages",attrs:{background:"",layout:"total, prev, pager, next,jumper","hide-on-single-page":!0,"page-size":t.perPage,total:t.totalRecords,"current-page":t.currentPage},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.changePage}})],2)},i=[],n={name:"cms-list",props:["data","total","per","pages","page"],data:function(){return{currentPage:this.page||1}},computed:{list:function(){return this.data},totalRecords:function(){return this.total},totalPages:function(){return this.pages},perPage:function(){return this.per},hasNextPage:function(){return this.totalRecords>1&&this.currentPage<this.totalPages}},methods:{appendPage:function(){this.$emit("appendPage",++this.currentPage)},changePage:function(t){this.$emit("changePage",t),this.$route.query.page=t}},watch:{page:function(t){this.currentPage=t}},mounted:function(){},components:{}},o=n,c=(a("735f"),a("2877")),r=Object(c["a"])(o,s,i,!1,null,null,null);e["a"]=r.exports},a5b9:function(t,e,a){},e315:function(t,e,a){"use strict";a("46a7")}}]);
//# sourceMappingURL=chunk-57d362ae.7a717db1.js.map