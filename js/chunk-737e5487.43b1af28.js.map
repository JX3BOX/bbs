{"version":3,"sources":["webpack:///./node_modules/@jx3box/jx3box-emotion/index.js","webpack:///./src/service/joke.js","webpack:///./src/views/Index.vue?b2ca","webpack:///./src/components/joke/joke_index.vue?d1a6","webpack:///src/components/joke/joke_index.vue","webpack:///./src/components/joke/joke_index.vue?b864","webpack:///./src/components/joke/joke_index.vue","webpack:///src/views/Index.vue","webpack:///./src/views/Index.vue?d8a1","webpack:///./src/views/Index.vue","webpack:///./src/views/Index.vue?1c14"],"names":["JX3_EMOTION","joke","this","_joke","trim","init","code","_renderHTML","str","emotionKeys","Object","keys","_initEmotions","data","obj","forEach","key","pathKey","slice","imgPath","replacer","_emotions","replaceAll","mapper","pattern","RegExp","join","replace","match","patterns","allKeys","test","filter","emotion","includes","reduce","before","value","assign","length","getRecommendedJokes","$next","mute","get","postJoke","post","getJokes","params","$cms","getJoke","id","starJoke","put","unstarJoke","removeJoke","delete","_vm","_h","$createElement","_c","_self","staticClass","staticRenderFns","attrs","icon","_v","_l","item","i","_s","author","domProps","html","component"],"mappings":"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","file":"js/chunk-737e5487.43b1af28.js","sourcesContent":["/**\r\n * @description: 骚话渲染\r\n * @author: Kaviilee\r\n * @version: 1.0.0\r\n */\r\n\r\nimport $ from \"jquery\";\r\nimport emotions from \"./data/default.json\";\r\nimport { __imgPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\r\n\r\nclass JX3_EMOTION {\r\n    /**\r\n     * @param {string} joke 骚话字符串\r\n     */\r\n    constructor(joke) {\r\n        this._joke = $.trim(joke);\r\n\r\n        this.init();\r\n    }\r\n\r\n    // 初始化实例\r\n    init() {\r\n        this.code = this._renderHTML();\r\n\r\n        return;\r\n    }\r\n\r\n    _renderHTML() {\r\n        let str = this._joke;\r\n\r\n        const emotionKeys = Object.keys(emotions);\r\n\r\n        const _initEmotions = (data) => {\r\n            const keys = Object.keys(data);\r\n\r\n            const obj = {};\r\n\r\n            keys.forEach((key) => {\r\n                const pathKey = key.slice(1);\r\n                const imgPath = __imgPath + `image/emotion/${pathKey}.gif`;\r\n\r\n                obj[key] = imgPath;\r\n            });\r\n\r\n            return obj;\r\n        };\r\n\r\n        const replacer = (str) => {\r\n            let _emotions = _initEmotions(emotions);\r\n            return `<img src=\"${_emotions[str]}\" alt=\"${str}\" title=\"${str}\" />`;\r\n        };\r\n\r\n        const replaceAll = (str, mapper) => {\r\n            const pattern = new RegExp(Object.keys(mapper).join(\"|\"), \"gi\");\r\n            return str.replace(pattern, (match) => mapper[match]);\r\n        }\r\n\r\n        const patterns = [ /(#[\\u4e00-\\u9fa5]{1})/g, /(#[\\u4e00-\\u9fa5]{2})/g, /(#[\\u4e00-\\u9fa5]{3})/g ];  // Emotion keys has maximum of 3 chars\r\n        let allKeys = {};\r\n\r\n        patterns.forEach((pattern) => {\r\n            if (pattern.test(str)) {\r\n                let keys = str.match(pattern)\r\n                    .filter((emotion) => emotionKeys.includes(emotion))                         // Only valid\r\n                    .reduce((before, value) => ({ ...before, [value]: replacer(value) }), {});  // Get HTML element and deduplicate to dict\r\n                allKeys = Object.assign({}, allKeys, keys);                                     // Append to main dict for rendering\r\n            }\r\n        });\r\n\r\n        if (Object.keys(allKeys).length > 0)\r\n            str = replaceAll(str, allKeys);\r\n\r\n        return str;\r\n    }\r\n}\r\n\r\nexport default JX3_EMOTION;\r\n","import { $cms, $next } from \"@jx3box/jx3box-common/js/https\";\n\n// 获取推荐骚话\nfunction getRecommendedJokes() {\n    return $next({ mute: true }).get(`/api/joke/recommended`);\n}\n\n// 发布\nfunction postJoke(data) {\n    return $next().post(`/api/joke/share`, data);\n}\n\n// 获取 joke 列表\nconst getJokes = (params) => {\n    return $cms().get(\"/api/cms/post/jokes\", {\n        params: params,\n    });\n};\n\n// 获取指定骚话\nfunction getJoke(id) {\n    return $cms().get(`/api/cms/post/joke/${id}`);\n}\n\n// 标星\nconst starJoke = (id) => {\n    return $cms().put(`/api/cms/post/joke/${id}/star`);\n};\n// 取消标星\nfunction unstarJoke(id){\n    return $cms().put(`/api/cms/post/joke/${id}/unstar`);\n}\n\n// 删除\nconst removeJoke = (id) => {\n    return $cms().delete(`/api/cms/post/joke/${id}`);\n};\n\nexport { getJokes, getJoke, starJoke, removeJoke, getRecommendedJokes,postJoke,unstarJoke };\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"v-index\"},[_c('joke')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"m-index-joke\"},[_c('h3',{staticClass:\"u-label\"},[_c('img',{staticClass:\"u-icon\",attrs:{\"src\":_vm.icon}}),_vm._v(\"今日骚话 \")]),_c('div',{staticClass:\"u-content\"},[_c('el-carousel',{attrs:{\"height\":\"20px\",\"direction\":\"vertical\",\"autoplay\":true}},_vm._l((_vm.data),function(item,i){return _c('el-carousel-item',{key:i},[_c('a',{staticClass:\"u-item\",attrs:{\"href\":'/bbs/#/joke/' + item.id,\"target\":\"_blank\"}},[_c('span',{staticClass:\"u-author\"},[_vm._v(_vm._s(item.author || '匿名'))]),_c('span',{staticClass:\"u-div\"},[_vm._v(\" : \")]),_c('span',{staticClass:\"u-joke\",domProps:{\"innerHTML\":_vm._s(item.html)}})])])}),1)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"m-index-joke\">\n        <h3 class=\"u-label\">\n            <img class=\"u-icon\" :src=\"icon\" />今日骚话\n        </h3>\n        <div class=\"u-content\">\n            <el-carousel height=\"20px\" direction=\"vertical\" :autoplay=\"true\">\n                <el-carousel-item v-for=\"(item,i) in data\" :key=\"i\">\n                    <a class=\"u-item\" :href=\"'/bbs/#/joke/' + item.id\" target=\"_blank\">\n                        <span class=\"u-author\">{{item.author || '匿名'}}</span>\n                        <span class=\"u-div\"> : </span>\n                        <span class=\"u-joke\" v-html=\"item.html\"></span>\n                    </a>\n                </el-carousel-item>\n            </el-carousel>\n        </div>\n        <!-- <a class=\"u-publish\" target=\"_blank\" href=\"/publish/#/joke\">\n            <i class=\"el-icon-s-promotion\"></i> 说骚话\n        </a> -->\n    </div>\n</template>\n\n<script>\nimport lodash from \"lodash\";\nimport { __imgPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\nimport { getLink } from \"@jx3box/jx3box-common/js/utils\";\nimport { getRecommendedJokes } from \"@/service/joke\";\nimport JX3_EMOTION from \"@jx3box/jx3box-emotion\";\n\nexport default {\n    name: \"joke\",\n    props: [],\n    components: {},\n    data: function () {\n        return {\n            data: [],\n            icon: __imgPath + \"image/box/joke.svg\",\n        };\n    },\n    computed: {},\n    methods: {\n        getLink,\n        init: function () {\n            getRecommendedJokes().then((res) => {\n                this.data = res.data.data.list;\n                this.render();\n            });\n        },\n        render: function () {\n            this.data.forEach((item) => {\n                const ins = new JX3_EMOTION(item.content);\n                item.html = ins.code;\n            });\n        },\n    },\n    filters: {},\n    created: function () {},\n    mounted: function () {\n        this.init();\n    },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./joke_index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./joke_index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./joke_index.vue?vue&type=template&id=61558fdc&\"\nimport script from \"./joke_index.vue?vue&type=script&lang=js&\"\nexport * from \"./joke_index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n    <div class=\"v-index\">\n        <joke />\n        <!-- <emotion /> -->\n        <!-- <list /> -->\n    </div>\n</template>\n\n<script>\n// import emotion from \"@/components/emotion/emotion_index.vue\";\n// import list from \"@/components/bbs/list_index.vue\";\nimport joke from \"@/components/joke/joke_index.vue\";\nexport default {\n    name: \"Index\",\n    props: [],\n    components: {\n        // list,\n        joke,\n        // emotion,\n    },\n    data: function () {\n        return {};\n    },\n    computed: {},\n    watch: {},\n    methods: {},\n    filters: {},\n    created: function () {},\n    mounted: function () {},\n};\n</script>\n\n<style lang=\"less\">\n@import \"../assets/css/index.less\";\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Index.vue?vue&type=template&id=704abe2c&\"\nimport script from \"./Index.vue?vue&type=script&lang=js&\"\nexport * from \"./Index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Index.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/vue-svg-inline-loader/dist/index.min.js!./Index.vue?vue&type=style&index=0&lang=less&\""],"sourceRoot":""}