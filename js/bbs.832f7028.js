(function(t){function e(e){for(var n,a,r=e[0],l=e[1],c=e[2],d=0,p=[];d<r.length;d++)a=r[d],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&p.push(i[a][0]),i[a]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(p.length)p.shift()();return s.push.apply(s,c||[]),o()}function o(){for(var t,e=0;e<s.length;e++){for(var o=s[e],n=!0,r=1;r<o.length;r++){var l=o[r];0!==i[l]&&(n=!1)}n&&(s.splice(e--,1),t=a(a.s=o[0]))}return t}var n={},i={bbs:0},s=[];function a(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=t,a.c=n,a.d=function(t,e,o){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(o,n,function(e){return t[e]}.bind(null,n));return o},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="https://cdn.jx3box.com/static/bbs/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;s.push([1,"chunk-vendors","chunk-common"]),o()})({"0ec0":function(t,e,o){"use strict";o("d8c3")},1:function(t,e,o){t.exports=o("19e9")},"19e9":function(t,e,o){"use strict";o.r(e);o("e260"),o("e6cf"),o("cca6"),o("a79d");var n=o("2b0e"),i=o("5c96"),s=o.n(i),a=o("6a69"),r=(o("6b30"),o("c5b4"),o("4360")),l=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"p-bbs p-bbs-single",attrs:{id:"app"}},[o("Header"),o("Breadcrumb",{attrs:{name:"茶馆交流",slug:"bbs",publishEnable:!1,adminEnable:!0,feedbackEnable:!0,crumbEnable:!0}},[o("publish-gate",{attrs:{slot:"op-append"},slot:"op-append"})],1),o("LeftSidebar",{attrs:{uid:t.user_id}},[o("Nav",{attrs:{id:t.id}})],1),o("Main",{attrs:{withoutRight:!1}},[o("single",{attrs:{id:t.id}}),o("RightSidebar",{attrs:{"show-toggle":!0}},[o("Side",{staticClass:"m-extend",attrs:{id:t.id}})],1),o("Footer")],1)],1)},c=[],u=o("0e1c"),d=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"m-single-side"},[t.id?o("PostTopic",{attrs:{type:"bbs",id:~~t.id}}):t._e(),o("PostDirectory",{attrs:{id:"directory"}}),t.showSideCollection?o("PostCollection",{attrs:{store:t.collection_data}}):t._e()],1)},p=[],f=o("6370"),h=o("7221"),v=o("bf34"),m={name:"single_side",props:["id"],data:function(){return{}},components:{PostDirectory:f["a"],PostCollection:h["a"],PostTopic:v["a"]},computed:{hasDirectory:function(){var t;return null===(t=this.$store.state.extend)||void 0===t?void 0:t.directory},showSideCollection:function(){var t,e,o=null===(t=this.$store.state.post)||void 0===t?void 0:t.post_collection,n=!(null!==(e=this.$store.state.post)&&void 0!==e&&e.collection_collapse);return o&&n},collection_data:function(){var t;return null===(t=this.$store.state.extend)||void 0===t?void 0:t.collection_data}}},_=m,b=(o("a461"),o("2877")),g=Object(b["a"])(_,d,p,!1,null,null,null),y=g.exports,w=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("singlebox",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{post:t.post,stat:t.stat},on:{extendUpdate:t.updateExtend}},[o("div",{staticClass:"u-meta u-sub-block",attrs:{slot:"single-header"},slot:"single-header"},[o("em",{staticClass:"u-label"},[t._v("类型")]),o("span",{staticClass:"u-value"},[t._v(" "+t._s(t.post_subtype)+" ")])])])},C=[],x=(o("d3b7"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"m-single-box"},[o("PostHeader",{attrs:{post:t.post,stat:t.stat}},[t._t("single-header")],2),o("div",{staticClass:"m-single-prepend"},[o("Creators",{staticClass:"m-single-creators",attrs:{postId:t.id,postType:t.post_type},on:{"load-authors":t.loadAuthors}}),o("Collection",{staticClass:"m-single-collection",attrs:{id:t.collection_id,defaultVisible:t.collection_collapse},on:{collectionUpdate:t.updateCollection}}),t._t("single-prepend")],2),t.visible?o("div",{staticClass:"m-single-post"},[o("el-divider",{attrs:{"content-position":"left"}},[t._v("JX3BOX")]),o("div",{staticClass:"m-single-content"},[t._t("default"),t.isMarkdown?o("ArticleMarkdown",{attrs:{content:t.post_content},on:{directoryRendered:t.updateDirectory}}):o("Article",{attrs:{content:t.post_content},on:{directoryRendered:t.updateDirectory}})],2)],1):o("div",{staticClass:"m-single-null"},[o("el-alert",{attrs:{title:t.null_tip,type:"warning","show-icon":""}})],1),o("div",{staticClass:"m-single-append"},[t._t("single-append"),o("Thx",{staticClass:"m-single-thx",attrs:{postId:t.id,postType:t.post_type,postTitle:t.post_title,userId:t.author_id,adminBoxcoinEnable:!0,userBoxcoinEnable:!0,authors:t.authors,client:t.post_client,allowGift:t.allow_gift}}),o("div",{ref:"commentView",staticClass:"m-single-comment"},[o("el-divider",{attrs:{"content-position":"left"}},[t._v("评论")]),t.showComment?[t.id&&t.allow_comment?o("Comment",{attrs:{id:t.id,category:"post"}}):o("el-alert",{attrs:{title:"作者没有开启评论功能",type:"warning","show-icon":""}})]:o("el-alert",{attrs:{title:"作者开启了评论仅自己可见",type:"warning","show-icon":""}})],2)],2),o("footer",{staticClass:"m-single-footer"},[t._t("single-footer")],2),o("right-affix",{attrs:{postId:t.id,postType:t.post_type,postTitle:t.post_title,showComment:t.id&&t.allow_comment},on:{toComment:function(e){return t.toComment(e)}}})],1)}),O=[],j=o("2909"),$=(o("99af"),o("caad"),o("2532"),o("0cf2")),E=o("0016"),P=o("18e2"),k=o("2e26"),T=o("443c"),A=o("a974"),S=o("f305"),I=o("23d8"),M=o("65c2"),D=o("85e4"),R=o("c9d2"),B={name:"cms-single",components:{PostHeader:$["a"],Creators:E["a"],Collection:P["a"],Thx:k["a"],Article:A["a"],ArticleMarkdown:S["a"],Comment:I["a"],RightAffix:T["a"]},props:["post","stat"],data:function(){return{collection_data:"",directory:!1,other_authors:[],super_author:""}},computed:{id:function(){var t;return~~(null===(t=this.post)||void 0===t?void 0:t.ID)||0},app_type:function(){return Object(D["getAppType"])()},post_type:function(){var t;return null===(t=this.post)||void 0===t?void 0:t.post_type},post_title:function(){var t;return null===(t=this.post)||void 0===t?void 0:t.post_title},author_id:function(){var t;return null===(t=this.post)||void 0===t?void 0:t.post_author},collection_id:function(){var t;return null===(t=this.post)||void 0===t?void 0:t.post_collection},collection_collapse:function(){var t;return null===(t=this.post)||void 0===t?void 0:t.collection_collapse},visible:function(){var t;return!(null===(t=this.post)||void 0===t||!t._check)},null_tip:function(){var t,e="作者设置了【";return e+=M["__visibleMap"][null===(t=this.post)||void 0===t?void 0:t.visible],e+="】",e},post_content:function(){var t;return(null===(t=this.post)||void 0===t?void 0:t.post_content)||""},post_mode:function(){var t;return(null===(t=this.post)||void 0===t?void 0:t.post_mode)||"tinymce"},isMarkdown:function(){return"markdown"==this.post_mode},allow_comment:function(){var t;return!(null!==(t=this.post)&&void 0!==t&&t.comment)},extend_data:function(){return{collection_data:this.collection_data,directory:this.directory}},authors:function(){return this.other_authors&&this.other_authors.length?[this.super_author].concat(Object(j["a"])(this.other_authors)):[]},post_client:function(){var t;return(null===(t=this.post)||void 0===t?void 0:t.client)||"all"},allow_gift:function(){var t;return null===(t=this.post)||void 0===t?void 0:t.allow_gift},isEditor:function(){return R["a"].isEditor()},showComment:function(){var t,e;return null===(t=this.post)||void 0===t||!t.comment_visible||((null===(e=R["a"].getInfo())||void 0===e?void 0:e.uid)==this.author_id||this.isEditor)}},methods:{updateCollection:function(t){this.collection_data=t},updateDirectory:function(t){this.directory=t},loadAuthors:function(t){var e=t.super_author,o=t.other_authors;this.super_author=e,this.other_authors=o},toComment:function(){this.$refs.commentView.scrollIntoView({block:"center",behavior:"auto"})}},watch:{extend_data:{deep:!0,immediate:!0,handler:function(t){this.$emit("extendUpdate",t)}},post_type:{deep:!0,immediate:!0,handler:function(t){location.host.includes("localhost")||t&&t!==this.app_type&&(location.href="/".concat(t,"/").concat(this.id))}}}},J=B,N=(o("84f1"),Object(b["a"])(J,x,O,!1,null,null,null)),V=N.exports,H=o("29c2"),U=o("9616"),X=o("f3bc"),q=o("1fb9"),F={name:"single",props:["id"],data:function(){return{loading:!1,post:{},stat:{}}},computed:{post_subtype:function(){var t,e,o=null===(t=this.post)||void 0===t?void 0:t.post_subtype;return o?null===(e=X[o])||void 0===e?void 0:e["label"]:"-"}},methods:{updateExtend:function(t){this.$store.state.extend=t}},mounted:function(){var t=this;this.id&&(this.loading=!0,Object(H["a"])(this.id).then((function(e){var o;t.post=t.$store.state.post=e.data.data,t.$store.state.id=t.id,t.$store.state.user_id=null===(o=t.post)||void 0===o?void 0:o.post_author,document.title=t.post.post_title})).finally((function(){t.loading=!1})),Object(U["a"])(q["a"],this.id).then((function(e){t.stat=t.$store.state.stat=e.data})),Object(U["b"])(q["a"],this.id))},components:{singlebox:V}},G=F,L=(o("9eb4"),Object(b["a"])(G,w,C,!1,null,null,null)),z=L.exports,K=o("98e8"),Q={name:"App",props:[],data:function(){return{id:Object(D["getAppID"])()}},computed:{user_id:function(){return this.$store.state.user_id}},methods:{getAppIcon:D["getAppIcon"]},components:{Nav:u["a"],Side:y,single:z,"publish-gate":K["a"]}},W=Q,Y=(o("0ec0"),Object(b["a"])(W,l,c,!1,null,null,null)),Z=Y.exports;n["default"].config.productionTip=!1,n["default"].use(s.a),n["default"].use(a["a"]),new n["default"]({store:r["a"],render:function(t){return t(Z)}}).$mount("#app")},"29c2":function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"a",(function(){return s}));var n=o("41cb");function i(t){var e={type:"bbs"};return t&&(e=Object.assign(e,t)),Object(n["a"])().get("/api/cms/posts",{params:e})}function s(t){return Object(n["a"])().get("/api/cms/post/".concat(t))}},"2ca8":function(t,e,o){},"4f87":function(t,e,o){},"84f1":function(t,e,o){"use strict";o("2ca8")},"9eb4":function(t,e,o){"use strict";o("d2b9")},a461:function(t,e,o){"use strict";o("4f87")},d2b9:function(t,e,o){},d8c3:function(t,e,o){},f3bc:function(t){t.exports=JSON.parse('{"1":{"label":"攻略心得","icon":"el-icon-collection"},"2":{"label":"江湖回忆","icon":"el-icon-headset"},"3":{"label":"同人创作","icon":"el-icon-film"},"4":{"label":"交流讨论","icon":"el-icon-chat-line-square"}}')}});
//# sourceMappingURL=bbs.832f7028.js.map