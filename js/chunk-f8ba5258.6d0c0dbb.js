(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f8ba5258"],{"13a0":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-collection"},["list"==t.mode?a("List"):a("Single")],1)},n=[],s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-collection-box"},[a("div",{staticClass:"m-archive-search"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入搜索内容"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[a("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("关键词")]),a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),t.data&&t.data.length?a("div",{staticClass:"m-collection-list"},t._l(t.data,(function(t,e){return a("div",{key:e},[a("collection-item",{attrs:{data:t}})],1)})),0):a("el-alert",{attrs:{title:"没有找到相关条目",type:"info","show-icon":""}}),a("el-pagination",{staticClass:"m-collection-pagination",attrs:{background:"","page-size":t.per,"hide-on-single-page":!0,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.total},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.skipTop}})],1)},o=[],l=(a("ac1f"),a("841c"),a("d3b7"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-collection-item"},[a("router-link",{staticClass:"u-image",attrs:{to:{name:"collection",params:{id:t.data.id}},target:"_blank"}},[a("img",{attrs:{src:t._f("getCover")(t.data.image)}})]),a("div",{staticClass:"u-content"},[a("router-link",{staticClass:"u-title",attrs:{to:{name:"collection",params:{id:t.data.id}},target:"_blank"}},[t._v(" "+t._s(t.data.title)+" ")]),a("div",{staticClass:"u-info"},[a("a",{staticClass:"u-user",attrs:{href:t._f("authorLink")(t.data.user_id),target:"_blank"}},[a("img",{staticClass:"u-avatar",attrs:{src:t._f("showAvatar")(t.data.user_avatar)}}),a("span",{staticClass:"u-nickname",domProps:{textContent:t._s(t.data.user_nickname)}})])]),a("div",{staticClass:"u-posts"},[a("el-row",{attrs:{gutter:80}},t._l(t.data.posts.slice(0,8),(function(e,i){return a("el-col",{key:i,attrs:{span:6}},[a("a",{staticClass:"u-post",attrs:{href:"custom"===e.type?e.url:t.getLink(e.type,e.id),target:"_blank"}},[a("i",{staticClass:"el-icon-notebook-2"}),t._v(" "+t._s(e.title)+" ")])])})),1)],1),a("div",{staticClass:"u-meta"},[a("span",{staticClass:"u-updated"},[a("i",{staticClass:"el-icon-refresh"}),t._v(" 最后更新于"+t._s(t.dateFormat(t.data.updated))+" ")])])],1)],1)}),c=[],r=a("85e4"),u=a("65c2"),d=a("fb92"),p={name:"CollectionItem",props:["data"],components:{},data:function(){return{}},computed:{},watch:{},methods:{getLink:r["getLink"],dateFormat:function(t){return Object(d["a"])(new Date(1e3*t))}},filters:{getCover:function(t){return t?Object(r["resolveImagePath"])(t):"".concat(u["__imgPath"],"image/collection/default_cover.png")},authorLink:r["authorLink"],showAvatar:function(t){return Object(r["getThumbnail"])(t,20,!0)}},created:function(){},mounted:function(){}},m=p,h=a("2877"),f=Object(h["a"])(m,l,c,!1,null,null,null),v=f.exports,_=a("41cb"),g=a("4328"),C=a.n(g);function b(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(_["c"])()({method:"GET",url:"/api/post/collection/".concat(t),params:e})}function k(t){return Object(_["c"])()({method:"GET",url:"/api/post/collections",params:t})}function w(t){return Object(_["c"])()({method:"PUT",url:"/api/post/collection/remove",data:C.a.stringify({id:t})})}var x={name:"CollectionList",props:[],components:{"collection-item":v},data:function(){return{loading:!1,data:[],page:1,total:1,pages:1,per:10,search:""}},computed:{params:function(){return{page:this.page,limit:this.per,keyword:this.search}}},methods:{skipTop:function(){window.scrollTo(0,0)},loadData:function(){var t=this;this.loading=!0,k(this.params).then((function(e){var a,i,n,s;t.data=null===e||void 0===e||null===(a=e.data)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.data,t.total=null===e||void 0===e||null===(n=e.data)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.total})).finally((function(){t.loading=!1}))}},filters:{},watch:{params:{immediate:!0,deep:!0,handler:function(){this.loadData()}}},created:function(){},mounted:function(){}},y=x,L=Object(h["a"])(y,s,o,!1,null,null,null),j=L.exports,T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-collection-single"},[t.collection?[a("div",{staticClass:"m-collection-detail-content"},[a("div",{staticClass:"m-collection-detail-header"},[a("header",{staticClass:"m-single-header"},[a("div",{staticClass:"m-single-title"},[a("span",{staticClass:"u-title u-sub-block",attrs:{href:t.url,title:t.collection.title}},[t.collection.public?t._e():a("i",{staticClass:"u-private el-icon-lock",attrs:{title:"仅自己可见"}}),a("span",{staticClass:"u-title-text"},[t._v(t._s(t.collection.title))])])]),a("div",{staticClass:"m-single-info"},[a("div",{staticClass:"u-author u-sub-block"},[a("i",{staticClass:"u-author-icon"},[a("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 16",width:"12",height:"16","aria-hidden":"true",fill:"#444","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[a("path",{attrs:{"fill-rule":"evenodd",d:"M12 14.002a.998.998 0 01-.998.998H1.001A1 1 0 010 13.999V13c0-2.633 4-4 4-4s.229-.409 0-1c-.841-.62-.944-1.59-1-4 .173-2.413 1.867-3 3-3s2.827.586 3 3c-.056 2.41-.159 3.38-1 4-.229.59 0 1 0 1s4 1.367 4 4v1.002z"}})])]),a("a",{staticClass:"u-name",attrs:{href:t._f("authorLink")(t.collection.user_id)}},[t._v(t._s(t.collection.user_nickname))])]),a("span",{staticClass:"u-podate u-sub-block",attrs:{title:"发布日期"}},[a("i",{staticClass:"u-icon el-icon-date"}),a("time",[t._v(t._s(t.dateFormat(t.collection.created)))])]),a("span",{staticClass:"u-modate u-sub-block",attrs:{title:"最后更新"}},[a("i",{staticClass:"u-icon el-icon-refresh"}),a("time",[t._v(t._s(t.dateFormat(t.collection.updated)))])]),a("span",{staticClass:"u-views u-sub-block"},[a("i",{staticClass:"u-icon el-icon-view"}),t._v(" "+t._s(t.views)+" ")]),t.canEdit?a("a",{staticClass:"u-edit u-sub-block",attrs:{href:t.edit_link}},[a("i",{staticClass:"u-icon-edit el-icon-edit-outline"}),a("span",[t._v("编辑")])]):t._e(),t.canEdit?a("a",{staticClass:"u-delete u-sub-block",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.delete_handle(e,t.collection.id)}}},[a("i",{staticClass:"u-icon-remove el-icon-delete"}),a("span",[t._v("删除")])]):t._e()])])]),t.collection.description?[a("el-divider",{attrs:{"content-position":"left"}},[a("i",{staticClass:"el-icon-collection"}),t._v(" 小册简介 ")]),a("div",{staticClass:"u-description"},[a("p",{domProps:{innerHTML:t._s(t.collection.description)}})])]:t._e(),t.collection.posts&&t.collection.posts.length?[a("el-divider",{attrs:{"content-position":"left"}},[a("i",{staticClass:"el-icon-folder"}),t._v(" 小册文章 ")]),a("ul",{staticClass:"u-list"},t._l(t.collection.posts,(function(e,i){return a("li",{key:i,staticClass:"u-item"},[a("span",{staticClass:"u-item-order"},[t._v(t._s(i+1)+".")]),"custom"===e.type?a("span",{staticClass:"u-item-link"},[a("i",{staticClass:"el-icon-link"}),t._v("站外链接 ")]):t._e(),"custom"!==e.type&&e.user_id?a("a",{staticClass:"u-item-author",attrs:{target:"_blank",href:t._f("authorLink")(e.user_id)}},[a("img",{staticClass:"u-avatar",attrs:{src:t.getThumbnail(e.user_avatar,20,!0)}}),a("span",{staticClass:"u-nickname",domProps:{textContent:t._s(e.user_nickname)}}),a("span",{staticClass:"u-div"},[t._v("/")])]):t._e(),a("a",{staticClass:"u-item-title",attrs:{target:"_blank",href:"custom"===e.type?e.url:t.getLink(e.type,e.id)}},[t._v(t._s(e.title))]),e.updated?a("time",{staticClass:"u-updated",domProps:{textContent:t._s("最后更新于 "+t.dateFormat(e.updated))}}):t._e()])})),0)]:t._e()],2),a("Thx",{staticClass:"m-thx",attrs:{postId:t.id,postType:"collection",userId:t.author_id,adminBoxcoinEnable:!0,userBoxcoinEnable:!0}}),t.id?a("div",{staticClass:"m-comments"},[a("el-divider",{attrs:{"content-position":"left"}},[a("span",{staticStyle:{color:"#999999"}},[a("i",{staticClass:"el-icon-chat-line-square"}),t._v(" 讨论 ")])]),a("jx3-comment",{attrs:{id:t.id,category:"collection"}})],1):t._e()]:a("el-alert",{attrs:{title:"该剑三小册不存在或已被删除",type:"info",center:"","show-icon":"",closable:!1}})],2)},O=[],E=a("23d8");const P=Object.freeze({PRIVATE:0,PUBLIC:1,all(){return[this.PRIVATE,this.PUBLIC]}});var $=P,I=a("c9d2"),B=a("9616"),D={name:"CollectionSingle",props:[],components:{"jx3-comment":E["a"]},data:function(){return{collection:"",publish:$,url:location.href,views:0,loading:!1}},computed:{edit_link:function(){return Object(r["editLink"])("collection",this.collection.id)},id:function(){var t;return null===(t=this.collection)||void 0===t?void 0:t.id},author_id:function(){var t;return(null===(t=this.collection)||void 0===t?void 0:t.user_id)||0},canEdit:function(){return this.author_id==I["a"].getInfo().uid||I["a"].isEditor()}},watch:{"$route.params.id":{immediate:!0,handler:function(t){t&&(this.loadData(t),this.execStat(t))}}},methods:{getThumbnail:r["getThumbnail"],getLink:r["getLink"],getTypeLabel:r["getTypeLabel"],dateFormat:function(t){return Object(d["a"])(new Date(1e3*t))},delete_handle:function(t,e){var a=this;t.preventDefault(),this.$confirm("确认是否删除该剑三小册？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){w(e).then((function(t){a.$message.success(t.message),a.$router.push({name:"collection"})}))}))},loadData:function(t){var e=this;this.loading=!0,b(t,{post_extra:1}).then((function(t){var a,i;e.collection=(null===t||void 0===t||null===(a=t.data)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.collection)||{},e.$store.state.user_id=e.collection.user_id})).finally((function(){e.loading=!1}))},execStat:function(t){var e=this;Object(B["b"])("collection",t),Object(B["a"])("collection",t).then((function(t){e.views=t.data.views}))}},filters:{authorLink:r["authorLink"]},created:function(){},mounted:function(){}},F=D,S=(a("ca73"),Object(h["a"])(F,T,O,!1,null,"38e6bf88",null)),A=S.exports,z={name:"Collection",props:[],components:{List:j,Single:A},data:function(){return{}},computed:{mode:function(){var t;return null!==(t=this.$route)&&void 0!==t&&t.params.id?"single":"list"}},watch:{},methods:{},filters:{},created:function(){},mounted:function(){}},U=z,V=(a("ade4"),Object(h["a"])(U,i,n,!1,null,null,null));e["default"]=V.exports},add0:function(t,e,a){},ade4:function(t,e,a){"use strict";a("add0")},ca73:function(t,e,a){"use strict";a("f3f3")},f3f3:function(t,e,a){}}]);
//# sourceMappingURL=chunk-f8ba5258.6d0c0dbb.js.map