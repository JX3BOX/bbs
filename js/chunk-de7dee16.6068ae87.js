(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-de7dee16"],{"1ce6":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-collection-single"},[t.collection?[a("div",{staticClass:"m-collection-detail-content"},[a("div",{staticClass:"m-collection-detail-header"},[a("header",{staticClass:"m-single-header"},[a("div",{staticClass:"m-single-title"},[a("span",{staticClass:"u-title u-sub-block",attrs:{href:t.url,title:t.collection.title}},[t.collection.public?t._e():a("i",{staticClass:"u-private el-icon-lock",attrs:{title:"仅自己可见"}}),a("span",{staticClass:"u-title-text"},[t._v(t._s(t.collection.title))])])]),a("div",{staticClass:"m-single-info"},[a("div",{staticClass:"u-author u-sub-block"},[a("i",{staticClass:"u-author-icon"},[a("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 16",width:"12",height:"16","aria-hidden":"true",fill:"#444","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[a("path",{attrs:{"fill-rule":"evenodd",d:"M12 14.002a.998.998 0 01-.998.998H1.001A1 1 0 010 13.999V13c0-2.633 4-4 4-4s.229-.409 0-1c-.841-.62-.944-1.59-1-4 .173-2.413 1.867-3 3-3s2.827.586 3 3c-.056 2.41-.159 3.38-1 4-.229.59 0 1 0 1s4 1.367 4 4v1.002z"}})])]),a("a",{staticClass:"u-name",attrs:{href:t._f("authorLink")(t.collection.user_id)}},[t._v(t._s(t.collection.user_nickname))])]),a("span",{staticClass:"u-podate u-sub-block",attrs:{title:"发布日期"}},[a("i",{staticClass:"u-icon el-icon-date"}),a("time",[t._v(t._s(t.dateFormat(t.collection.created)))])]),a("span",{staticClass:"u-modate u-sub-block",attrs:{title:"最后更新"}},[a("i",{staticClass:"u-icon el-icon-refresh"}),a("time",[t._v(t._s(t.dateFormat(t.collection.updated)))])]),a("span",{staticClass:"u-views u-sub-block"},[a("i",{staticClass:"u-icon el-icon-view"}),t._v(" "+t._s(t.views)+" ")]),t.canEdit?a("a",{staticClass:"u-edit u-sub-block",attrs:{href:t.edit_link}},[a("i",{staticClass:"u-icon-edit el-icon-edit-outline"}),a("span",[t._v("编辑")])]):t._e(),t.canEdit?a("a",{staticClass:"u-delete u-sub-block",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.delete_handle(e,t.collection.id)}}},[a("i",{staticClass:"u-icon-remove el-icon-delete"}),a("span",[t._v("删除")])]):t._e()])])]),t.collection.description?[a("el-divider",{attrs:{"content-position":"left"}},[a("i",{staticClass:"el-icon-collection"}),t._v(" 小册简介 ")]),a("div",{staticClass:"u-description"},[a("p",{domProps:{innerHTML:t._s(t.resolveImagePath(t.collection.description))}})])]:t._e(),t.collection.posts&&t.collection.posts.length?[a("el-divider",{attrs:{"content-position":"left"}},[a("i",{staticClass:"el-icon-folder"}),t._v(" 小册文章 ")]),a("ul",{staticClass:"u-list"},t._l(t.collection.posts,(function(e,i){return a("li",{key:i,staticClass:"u-item"},[a("span",{staticClass:"u-item-order"},[t._v(t._s(i+1)+".")]),"custom"===e.type?a("span",{staticClass:"u-item-link"},[a("i",{staticClass:"el-icon-link"}),t._v("站外链接 ")]):t._e(),"custom"!==e.type&&e.user_id?a("a",{staticClass:"u-item-author",attrs:{target:"_blank",href:t._f("authorLink")(e.user_id)}},[a("img",{staticClass:"u-avatar",attrs:{src:t.showAvatar(e.user_avatar)}}),a("span",{staticClass:"u-nickname",domProps:{textContent:t._s(e.user_nickname)}}),a("span",{staticClass:"u-div"},[t._v("/")])]):t._e(),a("a",{staticClass:"u-item-title",attrs:{target:"_blank",href:"custom"===e.type?e.url:t.getLink(e.type,e.id)}},[t._v(t._s(e.title))]),e.updated?a("time",{staticClass:"u-updated",domProps:{textContent:t._s("最后更新于 "+t.dateFormat(e.updated))}}):t._e()])})),0)]:t._e()],2),a("Thx",{staticClass:"m-thx",attrs:{postId:t.id,postType:"collection",postTitle:t.title,userId:t.author_id,adminBoxcoinEnable:!0,userBoxcoinEnable:!0,client:"all"}}),t.id?a("div",{staticClass:"m-comments"},[a("el-divider",{attrs:{"content-position":"left"}},[a("span",{staticStyle:{color:"#999999"}},[a("i",{staticClass:"el-icon-chat-line-square"}),t._v(" 讨论 ")])]),a("jx3-comment",{attrs:{id:t.id,category:"collection"}})],1):t._e()]:a("el-alert",{attrs:{title:"该剑三小册不存在或已被删除",type:"info",center:"","show-icon":"",closable:!1}})],2)},s=[],o=(a("d3b7"),a("23d8"));const n=Object.freeze({PRIVATE:0,PUBLIC:1,all(){return[this.PRIVATE,this.PUBLIC]}});var r=n,l=a("73cd"),c=a("fb92"),u=a("85e4"),d=a("c9d2"),h=a("9616"),g={name:"CollectionSingle",props:[],components:{"jx3-comment":o["a"]},data:function(){return{collection:"",publish:r,url:location.href,views:0,loading:!1}},computed:{edit_link:function(){return Object(u["editLink"])("collection",this.collection.id)},id:function(){var t;return null===(t=this.collection)||void 0===t?void 0:t.id},author_id:function(){var t;return(null===(t=this.collection)||void 0===t?void 0:t.user_id)||0},canEdit:function(){return this.author_id==d["a"].getInfo().uid||d["a"].isEditor()},title:function(){return this.collection.title}},watch:{"$route.params.id":{immediate:!0,handler:function(t){t&&(this.loadData(t),this.execStat(t))}}},methods:{getThumbnail:u["getThumbnail"],getLink:u["getLink"],getTypeLabel:u["getTypeLabel"],showAvatar:u["showAvatar"],resolveImagePath:u["resolveImagePath"],dateFormat:function(t){return Object(c["a"])(new Date(1e3*t))},delete_handle:function(t,e){var a=this;t.preventDefault(),this.$confirm("确认是否删除该剑三小册？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(l["c"])(e).then((function(t){a.$message.success(t.message),a.$router.push({name:"collection"})}))}))},loadData:function(t){var e=this;this.loading=!0,Object(l["a"])(t,{post_extra:1}).then((function(t){var a,i;e.collection=(null===t||void 0===t||null===(a=t.data)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.collection)||{},e.$store.state.user_id=e.collection.user_id})).finally((function(){e.loading=!1}))},execStat:function(t){var e=this;Object(h["b"])("collection",t),Object(h["a"])("collection",t).then((function(t){e.views=t.data.views||0}))}},filters:{authorLink:u["authorLink"]},created:function(){},mounted:function(){}},_=g,m=(a("26ff"),a("2877")),p=Object(m["a"])(_,i,s,!1,null,"ccc03c4c",null);e["default"]=p.exports},"26ff":function(t,e,a){"use strict";a("3b90")},"3b90":function(t,e,a){},c9d2:function(t,e,a){"use strict";var i=a("85e4"),s=a("65c2"),o=a("c5d8"),n=a("c7b3"),r=a.n(n);function l(t){return console.log(t.response),Promise.reject(t)}function c(t,e){t["interceptors"]["response"].use((function(t){return t.data.code?Promise.reject(t):t}),(function(t){return l(t)}))}function u(t,e){t["interceptors"]["response"].use((function(t){return t.data.code?Promise.reject(t):t}),(function(t){return l(t)}))}function d(t){let e=t&&t.domain||s["__cms"],a={withCredentials:!0,auth:{username:localStorage&&localStorage.getItem("token")||"",password:"cms common request"},baseURL:e,headers:{}};const i=r.a.create(a);return u(i,t),i}function h(t){let e=t&&t.domain||s["__next"],a={withCredentials:!0,auth:{username:localStorage&&localStorage.getItem("token")||"",password:"next common request"},baseURL:e,headers:{}};const i=r.a.create(a);return c(i,t),i}function g(t){let e=t&&Object.assign(t,{domain:s["__pay"]})||{domain:s["__pay"]};return h(e)}class _{constructor(){this.expires=o["a"],this.created_at=0,this.logged_in=!1,this.profile={},this.anonymous={uid:0,group:0,name:"未登录",status:0,bind_wx:0,avatar:Object(i["showAvatar"])(null,"s"),avatar_origin:s["default_avatar"]},this.asset=""}check(){return this.isLogin()?(this.profile.uid=localStorage&&localStorage.getItem("uid"),this.profile.group=localStorage&&localStorage.getItem("group")||1,this.profile.token=localStorage&&localStorage.getItem("token"),this.profile.name=localStorage&&localStorage.getItem("name"),this.profile.status=localStorage&&localStorage.getItem("status"),this.profile.bind_wx=localStorage&&localStorage.getItem("bind_wx"),this.profile.avatar_origin=localStorage&&localStorage.getItem("avatar")||s["default_avatar"],this.profile.avatar=Object(i["showAvatar"])(this.profile.avatar_origin,"s")):this.profile=this.anonymous,this}refresh(t,e){return localStorage.setItem(t,e)}isLogin(){return this.created_at=localStorage.getItem("created_at")?localStorage.getItem("created_at"):-1/0,this.logged_in="true"==localStorage.getItem("logged_in"),this.logged_in&&Date.now()-this.created_at<this.expires}_save(t){localStorage.setItem("created_at",Date.now()),localStorage.setItem("logged_in",!0),localStorage.setItem("token",t.token),localStorage.setItem("uid",t.uid),localStorage.setItem("group",t.group),localStorage.setItem("name",t.name),localStorage.setItem("status",t.status),localStorage.setItem("bind_wx",t.bind_wx),localStorage.setItem("avatar",t.avatar)}update(t){return new Promise((e,a)=>{try{this._save(t),e(this)}catch(i){localStorage?(localStorage.clear(),this._save(t),e(value)):a(new Error("localStorage不可用"))}})}getInfo(){return this.check(),this.profile}destroy(){return d({domain:s["__server"]}).post("/account/logout").finally(()=>{localStorage.removeItem("created_at"),localStorage.setItem("logged_in","false"),localStorage.removeItem("token")})}toLogin(t){t=t?encodeURIComponent(t):encodeURIComponent(location.href),location.href=s["__Links"].account.login+"?redirect="+t}getToken(){return this.getInfo().token}getUUID(){return localStorage.getItem("device_id")}isEmailMember(){return this.getInfo().group>=8}isPhoneMember(){return this.getInfo().group>=16}isEditor(){return this.getInfo().group>=64}isAdmin(){return this.getInfo().group>=128}isDeveloper(){return this.getInfo().group>=256}isSuperAdmin(){return this.getInfo().group>=512}isSuperAuthor(){return this.isLogin()?d().get("/api/cms/user/is_super_author/"+this.getInfo().uid).then(t=>t.data.data):new Promise((t,e)=>{t(!1)})}hasBindwx(){return this.getInfo().bind_wx}_isVIP(t){let e=t.was_vip;if(e){let e=new Date(t.expire_date)-new Date>0;return e}return!1}_isPRO(t){let e=t.was_pro;if(e){let e=new Date(t.pro_expire_date)-new Date>0;return e}return!1}isVIP(){return this.asset?new Promise((t,e)=>{t(this._isPRO(this.asset)||this._isVIP(this.asset))}):this.getAsset().then(t=>this._isPRO(t)||this._isVIP(t))}isPRO(){return this.asset?new Promise((t,e)=>{t(this._isPRO(this.asset))}):this.getAsset().then(t=>this._isPRO(t))}getAsset(){return this.isLogin()?g().get("/api/vip/i").then(t=>{let e=t.data.data;return this.asset=e,e}):new Promise((t,e)=>{let a={was_vip:0,expire_date:"1970-02-02T16:00:00.000Z",total_day:0,was_pro:0,pro_expire_date:"1970-02-02T16:00:00.000Z",pro_total_day:0,rename_card_count:0,had_renamed:0,namespace_card_count:0,box_coin:0,points:0};this.asset=a,t(a)})}getLevel(t){for(let e in s["__userLevel"]){let a=s["__userLevel"][e];if(t>=a[0]&&t<a[1])return~~e}}}e["a"]=new _}}]);
//# sourceMappingURL=chunk-de7dee16.6068ae87.js.map