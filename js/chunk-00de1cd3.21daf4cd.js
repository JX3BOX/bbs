(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-00de1cd3"],{"13a0":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-collection"},["list"==t.mode?a("List"):a("Single")],1)},n=[],s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-collection-box"},[a("div",{staticClass:"m-archive-search m-collection-search"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入搜索内容"},model:{value:t.search,callback:function(e){t.search="string"===typeof e?e.trim():e},expression:"search"}},[a("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("关键词")]),a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),t.data&&t.data.length?a("div",{staticClass:"m-collection-list"},t._l(t.data,(function(t,e){return a("div",{key:e},[a("collection-item",{attrs:{data:t}})],1)})),0):a("el-alert",{staticClass:"m-collection-null",attrs:{title:"没有找到相关条目",type:"info","show-icon":""}}),a("el-pagination",{staticClass:"m-collection-pagination",attrs:{background:"","page-size":t.per,"hide-on-single-page":!0,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.total},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.skipTop}})],1)},o=[],l=(a("ac1f"),a("841c"),a("d3b7"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-collection-item"},[a("router-link",{staticClass:"u-image",attrs:{to:{name:"collection",params:{id:t.data.id}},target:"_blank"}},[a("img",{attrs:{src:t._f("getCover")(t.data.image)}})]),a("div",{staticClass:"u-content"},[a("router-link",{staticClass:"u-title",attrs:{to:{name:"collection",params:{id:t.data.id}},target:"_blank"}},[t._v(" "+t._s(t.data.title)+" ")]),a("div",{staticClass:"u-info"},[a("a",{staticClass:"u-user",attrs:{href:t._f("authorLink")(t.data.user_id),target:"_blank"}},[a("img",{staticClass:"u-avatar",attrs:{src:t._f("showAvatar")(t.data.user_avatar)}}),a("span",{staticClass:"u-nickname",domProps:{textContent:t._s(t.data.user_nickname)}})])]),a("div",{staticClass:"u-posts"},[a("el-row",{attrs:{gutter:80}},t._l(t.data.posts.slice(0,8),(function(e,i){return a("el-col",{key:i,attrs:{span:6}},[a("a",{staticClass:"u-post",attrs:{href:"custom"===e.type?e.url:t.getLink(e.type,e.id),target:"_blank"}},[a("i",{staticClass:"el-icon-notebook-2"}),t._v(" "+t._s(e.title)+" ")])])})),1)],1),a("div",{staticClass:"u-meta"},[a("span",{staticClass:"u-updated"},[a("i",{staticClass:"el-icon-refresh"}),t._v(" 最后更新于"+t._s(t.dateFormat(t.data.updated))+" ")])])],1)],1)}),c=[],r=a("85e4"),u=a("65c2"),d=a("fb92"),m={name:"CollectionItem",props:["data"],components:{},data:function(){return{}},computed:{},watch:{},methods:{getLink:r["getLink"],dateFormat:function(t){return Object(d["a"])(new Date(1e3*t))}},filters:{getCover:function(t){return t?Object(r["resolveImagePath"])(t):"".concat(u["__imgPath"],"image/collection/default_cover.png")},authorLink:r["authorLink"],showAvatar:function(t){return Object(r["getThumbnail"])(t,20,!0)}},created:function(){},mounted:function(){}},p=m,f=a("2877"),h=Object(f["a"])(p,l,c,!1,null,null,null),_=h.exports,v=a("41cb"),g=a("4328"),C=a.n(g);function b(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(v["b"])()({method:"GET",url:"/api/post/collection/".concat(t),params:e})}function k(t){return Object(v["b"])()({method:"GET",url:"/api/post/collections",params:t})}function y(t){return Object(v["b"])()({method:"PUT",url:"/api/post/collection/remove",data:C.a.stringify({id:t})})}var w={name:"CollectionList",props:[],components:{"collection-item":_},data:function(){return{loading:!1,data:[],page:1,total:1,pages:1,per:10,search:""}},computed:{params:function(){return{page:this.page,limit:this.per,keyword:this.search}}},methods:{skipTop:function(){window.scrollTo(0,0)},loadData:function(){var t=this;this.loading=!0,k(this.params).then((function(e){var a,i,n,s;t.data=null===e||void 0===e||null===(a=e.data)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.data,t.total=null===e||void 0===e||null===(n=e.data)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.total})).finally((function(){t.loading=!1}))}},filters:{},watch:{params:{immediate:!0,deep:!0,handler:function(){this.loadData()}}},created:function(){},mounted:function(){}},L=w,Y=Object(f["a"])(L,s,o,!1,null,null,null),x=Y.exports,T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-collection-single"},[t.collection?[a("div",{staticClass:"m-collection-detail-content"},[a("div",{staticClass:"m-collection-detail-header"},[a("header",{staticClass:"m-single-header"},[a("div",{staticClass:"m-single-title"},[a("span",{staticClass:"u-title u-sub-block",attrs:{href:t.url,title:t.collection.title}},[t.collection.public?t._e():a("i",{staticClass:"u-private el-icon-lock",attrs:{title:"仅自己可见"}}),a("span",{staticClass:"u-title-text"},[t._v(t._s(t.collection.title))])])]),a("div",{staticClass:"m-single-info"},[a("div",{staticClass:"u-author u-sub-block"},[a("i",{staticClass:"u-author-icon"},[a("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 16",width:"12",height:"16","aria-hidden":"true",fill:"#444","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[a("path",{attrs:{"fill-rule":"evenodd",d:"M12 14.002a.998.998 0 01-.998.998H1.001A1 1 0 010 13.999V13c0-2.633 4-4 4-4s.229-.409 0-1c-.841-.62-.944-1.59-1-4 .173-2.413 1.867-3 3-3s2.827.586 3 3c-.056 2.41-.159 3.38-1 4-.229.59 0 1 0 1s4 1.367 4 4v1.002z"}})])]),a("a",{staticClass:"u-name",attrs:{href:t._f("authorLink")(t.collection.user_id)}},[t._v(t._s(t.collection.user_nickname))])]),a("span",{staticClass:"u-podate u-sub-block",attrs:{title:"发布日期"}},[a("i",{staticClass:"u-icon el-icon-date"}),a("time",[t._v(t._s(t.dateFormat(t.collection.created)))])]),a("span",{staticClass:"u-modate u-sub-block",attrs:{title:"最后更新"}},[a("i",{staticClass:"u-icon el-icon-refresh"}),a("time",[t._v(t._s(t.dateFormat(t.collection.updated)))])]),a("span",{staticClass:"u-views u-sub-block"},[a("i",{staticClass:"u-icon el-icon-view"}),t._v(" "+t._s(t.views)+" ")]),t.canEdit?a("a",{staticClass:"u-edit u-sub-block",attrs:{href:t.edit_link}},[a("i",{staticClass:"u-icon-edit el-icon-edit-outline"}),a("span",[t._v("编辑")])]):t._e(),t.canEdit?a("a",{staticClass:"u-delete u-sub-block",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.delete_handle(e,t.collection.id)}}},[a("i",{staticClass:"u-icon-remove el-icon-delete"}),a("span",[t._v("删除")])]):t._e()])])]),t.collection.description?[a("el-divider",{attrs:{"content-position":"left"}},[a("i",{staticClass:"el-icon-collection"}),t._v(" 小册简介 ")]),a("div",{staticClass:"u-description"},[a("p",{domProps:{innerHTML:t._s(t.collection.description)}})])]:t._e(),t.collection.posts&&t.collection.posts.length?[a("el-divider",{attrs:{"content-position":"left"}},[a("i",{staticClass:"el-icon-folder"}),t._v(" 小册文章 ")]),a("ul",{staticClass:"u-list"},t._l(t.collection.posts,(function(e,i){return a("li",{key:i,staticClass:"u-item"},[a("span",{staticClass:"u-item-order"},[t._v(t._s(i+1)+".")]),"custom"===e.type?a("span",{staticClass:"u-item-link"},[a("i",{staticClass:"el-icon-link"}),t._v("站外链接 ")]):t._e(),"custom"!==e.type&&e.user_id?a("a",{staticClass:"u-item-author",attrs:{target:"_blank",href:t._f("authorLink")(e.user_id)}},[a("img",{staticClass:"u-avatar",attrs:{src:t.getThumbnail(e.user_avatar,20,!0)}}),a("span",{staticClass:"u-nickname",domProps:{textContent:t._s(e.user_nickname)}}),a("span",{staticClass:"u-div"},[t._v("/")])]):t._e(),a("a",{staticClass:"u-item-title",attrs:{target:"_blank",href:"custom"===e.type?e.url:t.getLink(e.type,e.id)}},[t._v(t._s(e.title))]),e.updated?a("time",{staticClass:"u-updated",domProps:{textContent:t._s("最后更新于 "+t.dateFormat(e.updated))}}):t._e()])})),0)]:t._e()],2),a("Thx",{staticClass:"m-thx",attrs:{postId:t.id,postType:"collection",userId:t.author_id,adminBoxcoinEnable:!0,userBoxcoinEnable:!0}}),t.id?a("div",{staticClass:"m-comments"},[a("el-divider",{attrs:{"content-position":"left"}},[a("span",{staticStyle:{color:"#999999"}},[a("i",{staticClass:"el-icon-chat-line-square"}),t._v(" 讨论 ")])]),a("jx3-comment",{attrs:{id:t.id,category:"collection"}})],1):t._e()]:a("el-alert",{attrs:{title:"该剑三小册不存在或已被删除",type:"info",center:"","show-icon":"",closable:!1}})],2)},M=[],j=a("23d8");const D=Object.freeze({PRIVATE:0,PUBLIC:1,all(){return[this.PRIVATE,this.PUBLIC]}});var O=D,E=a("c9d2"),P=a("9616"),$={name:"CollectionSingle",props:[],components:{"jx3-comment":j["a"]},data:function(){return{collection:"",publish:O,url:location.href,views:0,loading:!1}},computed:{edit_link:function(){return Object(r["editLink"])("collection",this.collection.id)},id:function(){var t;return null===(t=this.collection)||void 0===t?void 0:t.id},author_id:function(){var t;return(null===(t=this.collection)||void 0===t?void 0:t.user_id)||0},canEdit:function(){return this.author_id==E["a"].getInfo().uid||E["a"].isEditor()}},watch:{"$route.params.id":{immediate:!0,handler:function(t){t&&(this.loadData(t),this.execStat(t))}}},methods:{getThumbnail:r["getThumbnail"],getLink:r["getLink"],getTypeLabel:r["getTypeLabel"],dateFormat:function(t){return Object(d["a"])(new Date(1e3*t))},delete_handle:function(t,e){var a=this;t.preventDefault(),this.$confirm("确认是否删除该剑三小册？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){y(e).then((function(t){a.$message.success(t.message),a.$router.push({name:"collection"})}))}))},loadData:function(t){var e=this;this.loading=!0,b(t,{post_extra:1}).then((function(t){var a,i;e.collection=(null===t||void 0===t||null===(a=t.data)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.collection)||{},e.$store.state.user_id=e.collection.user_id})).finally((function(){e.loading=!1}))},execStat:function(t){var e=this;Object(P["b"])("collection",t),Object(P["a"])("collection",t).then((function(t){e.views=t.data.views}))}},filters:{authorLink:r["authorLink"]},created:function(){},mounted:function(){}},S=$,H=(a("ca73"),Object(f["a"])(S,T,M,!1,null,"38e6bf88",null)),B=H.exports,I={name:"Collection",props:[],components:{List:x,Single:B},data:function(){return{}},computed:{mode:function(){var t;return null!==(t=this.$route)&&void 0!==t&&t.params.id?"single":"list"}},watch:{},methods:{},filters:{},created:function(){},mounted:function(){}},A=I,F=(a("ade4"),Object(f["a"])(A,i,n,!1,null,null,null));e["default"]=F.exports},4208:function(t,e,a){!function(e,a){t.exports=a()}(0,(function(){"use strict";return function(t,e,a){t=t||{};var i=e.prototype,n={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function s(t,e,a,n){return i.fromToBase(t,e,a,n)}a.en.relativeTime=n,i.fromToBase=function(e,i,s,o,l){for(var c,r,u,d=s.$locale().relativeTime||n,m=t.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],p=m.length,f=0;f<p;f+=1){var h=m[f];h.d&&(c=o?a(e).diff(s,h.d,!0):s.diff(e,h.d,!0));var _=(t.rounding||Math.round)(Math.abs(c));if(u=c>0,_<=h.r||!h.r){_<=1&&f>0&&(h=m[f-1]);var v=d[h.l];l&&(_=l(""+_)),r="string"==typeof v?v.replace("%d",_):v(_,i,h.l,u);break}}if(i)return r;var g=u?d.future:d.past;return"function"==typeof g?g(r):g.replace("%s",r)},i.to=function(t,e){return s(t,e,this,!0)},i.from=function(t,e){return s(t,e,this)};var o=function(t){return t.$u?a.utc():a()};i.toNow=function(t){return this.to(o(this),t)},i.fromNow=function(t){return this.from(o(this),t)}}}))},a471:function(t,e,a){!function(e,i){t.exports=i(a("5a0c"))}(0,(function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var a=e(t),i={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(t,e){return"W"===e?t+"周":t+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(t,e){var a=100*t+e;return a<600?"凌晨":a<900?"早上":a<1100?"上午":a<1300?"中午":a<1800?"下午":"晚上"}};return a.default.locale(i,null,!0),i}))},add0:function(t,e,a){},ade4:function(t,e,a){"use strict";a("add0")},ca73:function(t,e,a){"use strict";a("f3f3")},f3f3:function(t,e,a){},fb92:function(t,e,a){"use strict";a.d(e,"a",(function(){return l})),a.d(e,"b",(function(){return o}));a("99af");var i=a("5a0c"),n=a.n(i),s=a("4208");function o(t){return n()().from(n()(t))}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.getFullYear(),n=t.getMonth()+1,s=t.getDate(),o=a?"".concat(i).concat(e).concat(c(n)).concat(e).concat(c(s)):"".concat(i).concat(e).concat(n).concat(e).concat(s);return o}function c(t){return t<10?"0"+t:t}a("a471"),n.a.locale("zh-cn"),n.a.extend(s)}}]);
//# sourceMappingURL=chunk-00de1cd3.21daf4cd.js.map