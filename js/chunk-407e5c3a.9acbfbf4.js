(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-407e5c3a"],{"24bf":function(t){t.exports=JSON.parse('{"a":["萌新指南","节日","活动","外观","同人","家园","红尘侠影","日记","树洞","随感","回忆录"]}')},"29c2":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return r})),a.d(e,"c",(function(){return o}));var n=a("41cb");function i(t){var e={type:"bbs"};return t&&(e=Object.assign(e,t)),Object(n["a"])().get("/api/cms/posts",{params:e})}function r(t){return Object(n["a"])().get("/api/cms/post/".concat(t))}function o(t){return Object(n["a"])().get("/api/cms/post/topics/count",{params:t})}},4208:function(t,e,a){!function(e,a){t.exports=a()}(0,(function(){"use strict";return function(t,e,a){t=t||{};var n=e.prototype,i={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function r(t,e,a,i){return n.fromToBase(t,e,a,i)}a.en.relativeTime=i,n.fromToBase=function(e,n,r,o,s){for(var c,u,l,d=r.$locale().relativeTime||i,p=t.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],h=p.length,f=0;f<h;f+=1){var m=p[f];m.d&&(c=o?a(e).diff(r,m.d,!0):r.diff(e,m.d,!0));var v=(t.rounding||Math.round)(Math.abs(c));if(l=c>0,v<=m.r||!m.r){v<=1&&f>0&&(m=p[f-1]);var b=d[m.l];s&&(v=s(""+v)),u="string"==typeof b?b.replace("%d",v):b(v,n,m.l,l);break}}if(n)return u;var g=l?d.future:d.past;return"function"==typeof g?g(u):g.replace("%s",u)},n.to=function(t,e){return r(t,e,this,!0)},n.from=function(t,e){return r(t,e,this)};var o=function(t){return t.$u?a.utc():a()};n.toNow=function(t){return this.to(o(this),t)},n.fromNow=function(t){return this.from(o(this),t)}}}))},"4d43":function(t,e,a){},"51eb":function(t,e,a){"use strict";var n=a("825a"),i=a("485a"),r=TypeError;t.exports=function(t){if(n(this),"string"===t||"default"===t)t="string";else if("number"!==t)throw new r("Incorrect hint");return i(this,t)}},"53ca":function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}},5916:function(t,e,a){"use strict";a.r(e);a("ac1f"),a("841c"),a("498a");var n=function(){var t=this,e=t._self._c;return e("ListLayout",[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-archive-box"},[e("div",{staticClass:"m-archive-search m-bbs-search",attrs:{slot:"search-before"},slot:"search-before"},[e("a",{staticClass:"u-publish el-button el-button--primary",attrs:{href:t.publish_link}},[t._v("+ 发布作品")]),e("el-input",{attrs:{placeholder:"请输入搜索内容",clearable:""},on:{clear:t.onSearch},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch.apply(null,arguments)}},model:{value:t.search,callback:function(e){t.search="string"===typeof e?e.trim():e},expression:"search"}},[e("span",{attrs:{slot:"prepend"},slot:"prepend"},[e("i",{staticClass:"el-icon-search"}),t._v(" "),e("span",{staticClass:"u-search"},[t._v("关键词")])]),e("el-button",{attrs:{slot:"append",icon:"el-icon-position"},on:{click:t.onSearch},slot:"append"})],1)],1),e("div",{staticClass:"m-bbs-tags"},[e("div",{staticClass:"u-tag",class:{active:""===t.tag},on:{click:function(e){return t.setTag("")}}},[t._v("全部")]),t._l(t.theme,(function(a){return e("div",{key:a,staticClass:"u-tag",class:{active:t.tag===a},on:{click:function(e){return t.setTag(a)}}},[t._v(" "+t._s(a)+" "),t.getCount(a)?e("span",{staticClass:"u-count"},[t._v("("+t._s(t.getCount(a))+")")]):t._e()])}))],2),e("list-top"),t.data&&t.data.length?e("div",{staticClass:"m-archive-list"},[e("ul",{staticClass:"u-list"},t._l(t.data,(function(a,n){return e("list-item",{key:n+a,attrs:{item:a,order:t.order,caller:"bbs_index_click"}})})),1)]):e("el-alert",{staticClass:"m-archive-null",attrs:{title:"没有找到相关条目",type:"info",center:"","show-icon":""}}),e("el-button",{directives:[{name:"show",rawName:"v-show",value:t.hasNextPage,expression:"hasNextPage"}],staticClass:"m-archive-more",attrs:{type:"primary",loading:t.loading,icon:"el-icon-arrow-down"},on:{click:t.appendPage}},[t._v("加载更多")]),e("el-pagination",{staticClass:"m-archive-pages",attrs:{background:"",layout:"total, prev, pager, next, jumper","hide-on-single-page":!0,"page-size":t.per,total:t.total,"current-page":t.page},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.changePage}})],1)])},i=[],r=a("2909"),o=a("ade3"),s=(a("99af"),a("2c3e"),a("d3b7"),a("d81d"),a("14d9"),a("b0c0"),a("7db0"),a("b64b"),a("caad"),a("2532"),a("1fb9")),c=function(){var t=this,e=t._self._c;return e("li",{staticClass:"u-item"},[e("a",{directives:[{name:"reporter",rawName:"v-reporter",value:{data:{href:t.reporterLink(t.item.ID)},caller:t.caller},expression:"{\n            data: {\n                href: reporterLink(item.ID),\n            },\n            caller,\n        }"}],staticClass:"u-banner",attrs:{href:t._f("postLink")(t.item.ID),target:t.target}},[e("img",{key:t.item.ID,attrs:{src:t.getBanner(t.item.post_banner,t.item.post_subtype)}})]),e("h2",{staticClass:"u-post",class:{isSticky:t.item.sticky}},[e("svg",{class:"u-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 16",width:"12",height:"16","aria-hidden":"true",fill:"#555","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"}})]),e("a",{directives:[{name:"reporter",rawName:"v-reporter",value:{data:{href:t.reporterLink(t.item.ID)},caller:t.caller},expression:"{\n            data: {\n                href: reporterLink(item.ID),\n            },\n            caller,\n        }"}],staticClass:"u-title",style:t._f("showHighlight")(t.item.color),attrs:{href:t._f("postLink")(t.item.ID),target:t.target}},[t._v(t._s(t.item.post_title||"无标题"))]),t.item.mark&&t.item.mark.length?e("span",{staticClass:"u-marks"},t._l(t.item.mark,(function(a){return e("i",{key:a,staticClass:"u-mark"},[t._v(t._s(t._f("showMark")(a)))])})),0):t._e()]),e("div",{staticClass:"u-content u-desc"},[t._v(" "+t._s(t.item.post_excerpt||t.item.post_title||"这个作者很懒,什么都没有留下")+" ")]),e("div",{staticClass:"u-misc"},[e("img",{staticClass:"u-author-avatar",attrs:{src:t._f("showAvatar")(t.item.author_info),alt:t._f("showNickname")(t.item.author_info)}}),e("a",{staticClass:"u-author-name",attrs:{href:t._f("authorLink")(t.item.post_author),target:"_blank"}},[t._v(t._s(t._f("showNickname")(t.item.author_info)))]),e("span",{staticClass:"u-date"},[t._v(" Updated on "),"update"==t.order?e("time",[t._v(t._s(t._f("dateFormat")(t.item.post_modified)))]):e("time",[t._v(t._s(t._f("dateFormat")(t.item.post_date)))])])])])},u=[],l=a("85e4"),d=a("65c2"),p=a("1647"),h=a("e4f1"),f={name:"ListItem",props:["item","order","caller"],components:{},data:function(){return{target:Object(l["buildTarget"])()}},computed:{client:function(){var t;return null===(t=this.item)||void 0===t?void 0:t.client}},watch:{},methods:{getBanner:function(t,e){return t?Object(l["showBanner"])(t):d["__imgPath"]+"image/banner/".concat(s["a"])+".png"},reporterLink:function(t){var e="std"===this.client?"www":"origin";return"".concat(e,":/").concat(s["a"],"/")+t}},filters:{authorLink:l["authorLink"],postLink:function(t){return location.origin+"/".concat(s["a"],"/")+t},showHighlight:function(t){return t?"color:".concat(t,";font-weight:600;"):""},showMark:function(t){return p["a"][t]||t},showAvatar:function(t){return Object(l["showAvatar"])(null===t||void 0===t?void 0:t.user_avatar)},showNickname:function(t){return(null===t||void 0===t?void 0:t.display_name)||"匿名"},dateFormat:function(t){return Object(h["a"])(new Date(t))}},created:function(){},mounted:function(){}},m=f,v=a("2877"),b=Object(v["a"])(m,c,u,!1,null,null,null),g=b.exports,y=a("29c2"),_=a("f3bc"),k=a("9398"),w=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-bbs-top"},[t._m(0),e("div",{staticClass:"m-bbs-top__content"},t._l(t.data,(function(a){return e("div",{key:a.id,staticClass:"m-bbs-top__item"},[e("div",{staticClass:"m-item_left"},[e("span",{staticClass:"u-type",style:t.itemTypeStyle(a)},[t._v(t._s(t.itemType(a,"label")))]),e("a",{staticClass:"u-title",class:{"is-bold":a.color},style:{color:a.color},attrs:{href:t.postLink(a.ID),target:"_blank"}},[t._v(t._s(a.post_title))])]),e("time",{staticClass:"u-time"},[t._v(t._s(t.fromNow(a.post_modified)))])])})),0)])},C=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-bbs-top__header"},[e("h3",{staticClass:"u-title"},[e("i",{staticClass:"el-icon-news"}),t._v("官方资讯")]),e("a",{staticClass:"u-more",attrs:{href:"/notice",target:"_blank"}},[t._v("全部 »")])])}],O=a("fb11"),j=a("5a0c"),x=a.n(j),L=a("4208"),N=a.n(L);x.a.extend(N.a),a("a471"),x.a.locale("zh-cn");var q={data:function(){return{data:[]}},mounted:function(){this.getNotice()},methods:{getNotice:function(){var t=this,e={per:3,page:1,sticky:1,type:"notice"};Object(y["b"])(e).then((function(e){t.data=e.data.data.list}))},itemType:function(t,e){var a=t.post_subtype;return O[a][e]},itemTypeStyle:function(t){return{}},postLink:function(t){return location.origin+"/notice/"+t},fromNow:function(t){return x()(t).fromNow()}}},S=q,T=(a("b952"),Object(v["a"])(S,w,C,!1,null,null,null)),D=T.exports,I=a("24bf"),P=a("41cb");function M(t){return Object(P["a"])().get("/api/cms/topic/bucket",{params:t})}var H=a("16e5"),z={name:"Index",props:[],data:function(){return{loading:!1,data:[],page:1,per:10,total:1,pages:1,number_queries:["per","page"],subtypes:_,subtype:"0",order:"update",mark:"",client:this.$store.state.client,search:"",theme:[],tag:"",topicsCount:[]}},computed:{publish_link:function(){return Object(l["publishLink"])(s["a"])},hasNextPage:function(){return this.pages>1&&this.page<this.total},query:function(){return{subtype:this.subtype,order:this.order,mark:this.mark,client:this.client,topic:this.tag}},pg_queries:function(){return{page:this.page,per:this.per}},reset_queries:function(){return[this.subtype,this.tag]}},methods:{reporterLink:function(t){var e="std"===this.client?"www":"origin";return"".concat(e,":/").concat(s["a"],"/")+t},onSearch:function(){1===this.page?this.loadData():this.page=1},buildQuery:function(t){t&&(this.page+=1);var e={per:this.per,page:this.page};for(var a in this.query)void 0!==this.query[a]&&""!==this.query[a]&&null!==this.query[a]&&("search"==a?e.search=this.query.search.trim():"subtype"==a?~~this.subtype&&(e.subtype=this.subtype):e[a]=this.query[a]);return e.sticky=1,this.search&&(e.search=this.search.trim()),e},loadData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=this.buildQuery(e);return console.log("[cms-list]","<loading data>",a),this.loading=!0,Object(y["b"])(a).then((function(a){var n,i,r,o,s,c,u,l,d,p;e?t.data=t.data.concat(null===(u=a.data)||void 0===u||null===(l=u.data)||void 0===l?void 0:l.list):t.data=null===(d=a.data)||void 0===d||null===(p=d.data)||void 0===p?void 0:p.list;t.total=null===(n=a.data)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.total,t.pages=null===(r=a.data)||void 0===r||null===(o=r.data)||void 0===o?void 0:o.pages,Object(H["b"])({caller:"bbs_index_load",data:{aggregate:null===(s=a.data)||void 0===s||null===(c=s.data)||void 0===c?void 0:c.list.map((function(e){return t.reporterLink(e.ID)}))}})})).finally((function(){t.loading=!1}))},replaceRoute:function(t){return this.$router.push({name:this.$route.name,query:Object.assign({},this.$route.query,t)}).then((function(){window.scrollTo(0,0)})).catch((function(t){}))},filterMeta:function(t){this.replaceRoute(Object(o["a"])(Object(o["a"])({},t["type"],t["val"]),"page",1))},filterImperceptibly:function(t){this[t["type"]]=t["val"]},changePage:function(t){this.loadData(),this.replaceRoute({page:t})},appendPage:function(){this.loadData(!0)},setTag:function(t){this.tag=this.tag===t?"":t,this.replaceRoute({tag:this.tag})},loadCount:function(){var t=this;Object(y["c"])({post_type:"bbs"}).then((function(e){t.topicsCount=e.data.data}))},getCount:function(t){var e;return(null===(e=this.topicsCount.find((function(e){return e.topic==t})))||void 0===e?void 0:e.count)||0},getTopicBucket:function(){var t=this;M({type:"bbs"}).then((function(e){var a,n=(null===(a=e.data.data)||void 0===a?void 0:a.map((function(t){return t.name})))||[];t.theme=[].concat(Object(r["a"])(I["a"]),Object(r["a"])(n))}))}},watch:{"$route.query":{deep:!0,immediate:!0,handler:function(t){if(Object.keys(t).length)for(var e in console.log("[cms-list]","<route query change>",t),t)this.number_queries.includes(e)?this[e]=~~t[e]:this[e]=t[e]}},reset_queries:{deep:!0,handler:function(){console.log("[cms-list]","<reset page>"),this.page=1}},query:{deep:!0,immediate:!0,handler:function(t){console.log("[cms-list]","<request query change>",t),this.loadData()}}},mounted:function(){this.loadCount(),this.getTopicBucket()},components:{listItem:g,ListLayout:k["a"],"list-top":D}},B=z,$=(a("cf9d"),Object(v["a"])(B,n,i,!1,null,null,null));e["default"]=$.exports},8172:function(t,e,a){"use strict";var n=a("e065"),i=a("57b9");n("toPrimitive"),i()},ade3:function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));var n=a("53ca");a("8172"),a("efec"),a("a4d3"),a("e01a"),a("d3b7"),a("d9e2"),a("a9e3");function i(t,e){if("object"!=Object(n["a"])(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var i=a.call(t,e||"default");if("object"!=Object(n["a"])(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function r(t){var e=i(t,"string");return"symbol"==Object(n["a"])(e)?e:String(e)}function o(t,e,a){return e=r(e),e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},b952:function(t,e,a){"use strict";a("b9ef")},b9ef:function(t,e,a){},cf9d:function(t,e,a){"use strict";a("4d43")},efec:function(t,e,a){"use strict";var n=a("1a2d"),i=a("cb2d"),r=a("51eb"),o=a("b622"),s=o("toPrimitive"),c=Date.prototype;n(c,s)||i(c,s,r)},f3bc:function(t){t.exports=JSON.parse('{"1":{"label":"攻略心得","icon":"el-icon-collection"},"2":{"label":"江湖回忆","icon":"el-icon-headset"},"3":{"label":"同人创作","icon":"el-icon-film"},"4":{"label":"交流讨论","icon":"el-icon-chat-line-square"}}')},fb11:function(t){t.exports=JSON.parse('{"1":{"label":"活动","color":"#a47df7"},"2":{"label":"公告","color":"#cc0000"},"3":{"label":"更新","color":"#0cd8f0"},"4":{"label":"通知","color":"#ffc632"}}')}}]);
//# sourceMappingURL=chunk-407e5c3a.9acbfbf4.js.map