(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-25b01d58"],{"0837":function(t,e,n){"use strict";n("b9c7")},"084d":function(t,e,n){},"0886":function(t,e,n){},"0b4e":function(t,e,n){"use strict";n("e7d2")},"23d8":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"c-comment"},[n("el-main",[n("CommentInputForm",{on:{submit:t.userSubmitInputForm}}),n("div",{staticClass:"c-comment-order"},[n("span",[t._v("排序模式：")]),n("el-switch",{on:{change:t.changeOrder},model:{value:t.isDesc,callback:function(e){t.isDesc=e},expression:"isDesc"}}),n("b",[t._v(t._s(t.isDesc?"最后靠前":"最早靠前"))])],1),t.isNormal?[t._l(t.commentList,(function(e){return n("div",{key:e.id,staticClass:"c-comment-list"},[n("Avatar",{attrs:{"user-avatar":t._f("showAvatar")(e.avatar),"user-href":t._f("profileLink")(e.userId),username:e.displayName,avatarFrame:e.user_avatar_frame,withFrame:!0}}),n("CommmentWithReply",{attrs:{"base-api":t.baseAPI,item:e,category:t.category,power:t.commentPower,"user-href":t._f("profileLink")(e.userId),username:e.displayName},on:{deteleComment:t.deteleComment}})],1)})),n("div",{staticClass:"c-comment-pages"},[t.commentList.length>5?n("CommentInputForm",{attrs:{isBottom:t.commentList.length>5},on:{submit:t.userSubmitInputForm}}):t._e(),n("div",{staticClass:"u-pages"},[n("el-pagination",{staticStyle:{"text-align":"right"},attrs:{background:"","hide-on-single-page":"","current-page":t.pager.index,"page-size":t.pager.pageSize,layout:"prev, pager, next, total",total:t.pager.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.pager,"index",e)},"update:current-page":function(e){return t.$set(t.pager,"index",e)}}})],1)],1)]:t._e()],2)],1)},a=[],o=(n("99af"),n("d3b7"),n("85e4")),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"c-comment-avatar"},[n("a",{staticClass:"u-avatar",attrs:{href:t.userHref,target:"_blank"}},[n("el-avatar",{staticClass:"u-avatar-pic",class:{isCircle:t.isCircle},attrs:{shape:"square",size:t.avatarSize,src:t.userAvatar}}),t.frameName?n("i",{staticClass:"u-avatar-frame"},[n("img",{attrs:{src:t.frameUrl}})]):t._e()],1),n("el-link",{staticClass:"u-name",attrs:{type:"primary",target:"_blank",href:t.userHref}},[t._v(t._s(t.username))])],1)},r=[],c=n("65c2"),l={props:["avatarSize","userAvatar","userHref","username","avatarFrame","withFrame"],data:function(){return{}},computed:{frames:function(){return this.$store.state.frames},frameName:function(){return this.avatarFrame&&this.frames[this.avatarFrame]?this.avatarFrame:""},frameUrl:function(){if(this.frameName){var t=this.frames[this.frameName].files.s.file;return c["__imgPath"]+"image/avatar/".concat(this.frameName,"/").concat(t)}return""},isCircle:function(){return this.frameName&&"circle"==this.frames[this.frameName].style}},methods:{},mounted:function(){}},u=l,d=(n("c0ba"),n("2877")),m=Object(d["a"])(u,s,r,!1,null,null,null),h=m.exports,f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-form",{ref:"form",staticClass:"c-comment-box",attrs:{model:t.newComment}},[n("el-form-item",[n("Emotion",{staticClass:"c-comment-emotion",on:{selected:t.handleEmotionSelected}}),n("el-input",{attrs:{rows:"3",type:"textarea",maxlength:"300","show-word-limit":"",placeholder:"参与讨论...",id:t.inputId},model:{value:t.newComment.content,callback:function(e){t.$set(t.newComment,"content",e)},expression:"newComment.content"}}),t.showUploader?n("Uploader",{ref:"uploader",staticClass:"u-uploader",on:{onFinish:t.attachmentUploadFinish,onError:t.attachmentUplodError}}):t._e(),n("div",{staticClass:"u-toolbar"},[n("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-picture",size:"mini"},on:{click:function(e){t.showUploader=!t.showUploader}}},[t._v("图片")]),n("el-button",{staticClass:"u-publish",attrs:{type:"primary",disabled:t.disableSubmitBtn},on:{click:t.onSubmit}},[t._v("发表评论")])],1)],1)],1)},p=[],g=n("1da1"),y=(n("96cf"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-upload",{ref:"upload",attrs:{action:"https://server.jx3box.com/upload","list-type":"picture-card","on-preview":t.handlePictureCardPreview,"auto-upload":!1,"file-list":t.fileList,limit:3,multiple:"","with-credentials":"","on-exceed":t.onExceed,"on-change":t.onChange,"on-success":t.onSuccess,"on-error":t.onError}},[n("i",{staticClass:"el-icon-plus"}),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 只能上传jpg/png/gif文件，且不超过500k的３张图片 ")])]),n("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("img",{attrs:{width:"60%",src:t.dialogImageUrl,alt:""}})])],1)}),v=[],b={data:function(){return{dialogImageUrl:"",dialogVisible:!1,fileList:[],successList:[]}},methods:{handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},onExceed:function(){this.$notify({title:"",message:"文件超过数量!",type:"error",duration:3e3,position:"bottom-right"})},onChange:function(t,e){"ready"==t.status&&(t.size>512e3?(this.$notify({title:"",message:"图片大小不能超过500kb!",type:"error",duration:3e3,position:"bottom-right"}),e.pop()):this.fileList=e)},upload:function(){this.fileList.length>0?this.$refs.upload.submit():this.$emit("onFinish",[])},onSuccess:function(t){this.successList=this.successList.concat(t.data.list),this.successList.length==this.fileList.length&&(this.$emit("onFinish",this.successList||[]),this.fileList=[],this.successList=[])},onError:function(){this.$notify({title:"",message:"图片上传失败!",type:"error",duration:3e3,position:"bottom-right"}),this.$emit("onError"),this.fileList=[]}}},_=b,w=Object(d["a"])(_,y,v,!1,null,null,null),k=w.exports,C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"c-jx3box-emotion"},[t._l(t.sortedEmotions,(function(e){return[n("span",{key:e.key,staticClass:"c-jx3box-emotion-item",on:{click:function(n){return t.handleEmotionClick(e.key)}}},[n("img",{attrs:{src:e.path,alt:e.key,title:e.key}})])]}))],2)},$=[],x=(n("b64b"),n("4e82"),n("159b"),n("fb6a"),n("e9a5")),j={name:"Emotion",data:function(){return{sortedEmotions:[]}},created:function(){this.emotionSort()},methods:{emotionSort:function(){var t=this,e=Object.keys(x);e.sort((function(t,e){return t.localeCompare(e)})),e.forEach((function(e){var n=e.slice(1),i={key:e,value:x[e],path:c["__imgPath"]+"image/emotion/".concat(n,".gif")};t.sortedEmotions.push(i)}))},handleEmotionClick:function(t){this.$emit("selected",t)}}},S=j,L=(n("f7729"),Object(d["a"])(S,C,$,!1,null,"305c0178",null)),M=L.exports,I={components:{Uploader:k,Emotion:M},props:{isBottom:{type:Boolean,default:!1}},mounted:function(){this.isBottom&&(this.inputId="textarea-bottom")},data:function(){return{showUploader:!1,disableSubmitBtn:!1,newComment:{content:""},inputId:"textarea-top"}},methods:{onSubmit:function(){this.disableSubmitBtn=!0,this.$refs.uploader?this.$refs.uploader.upload():this.attachmentUploadFinish([])},attachmentUploadFinish:function(t){this.$emit("submit",{content:this.newComment.content,attachmentList:t}),this.newComment={content:""},this.showUploader=!1,this.disableSubmitBtn=!1},attachmentUplodError:function(){this.disableSubmitBtn=!1},handleEmotionSelected:function(t){console.log(t),this.insertVariable(t)},insertVariable:function(t){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function n(){var i,a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=document.querySelector("#".concat(e.inputId)),!i.selectionStart&&0!==i.selectionStart){n.next=11;break}return a=i.selectionStart,o=i.selectionEnd,e.newComment.content=i.value.substring(0,a)+t+i.value.substring(o,i.value.length),n.next=7,e.$nextTick();case 7:i.focus(),i.setSelectionRange(o+t.length,o+t.length),n.next=12;break;case 11:e.newComment.content=t;case 12:case"end":return n.stop()}}),n)})))()}}},O=I,R=Object(d["a"])(O,f,p,!1,null,null,null),D=R.exports,E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"c-comment-cmt"},[n("el-link",{staticClass:"u-name",attrs:{type:"primary",target:"_blank",href:t.userHref}},[t._v(t._s(t.username||"人字榜800线无名小侠"))]),n("CommentContent",{attrs:{date:t.item.commentDate,content:t.item.content,"comment-id":t.item.id,attachments:t._f("stringToArray")(t.item.attachments),"can-delete":t.power.allow||t.power.uid==t.item.userId},on:{addNewReply:t.addNewReply,deteleComment:t.deteleComment}}),n("ReplyList",{attrs:{data:t.replyList,pager:t.pager,power:t.power},on:{addNewReply:t.addNewReply,deleteReply:t.deleteReply,goto:t.gotoReplyListIndex,resetReply:t.resetReply}})],1)},F=[],U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"u-cmt"},[""!=t.content?n("div",{staticClass:"u-text",domProps:{innerHTML:t._s(t.formatContent(t.content))}}):t._e(),t.attachments.length?n("div",{staticClass:"u-attachements"},t._l(t.attachments,(function(e){return n("el-image",{key:e,attrs:{src:t._f("showAttachment")(e),"preview-src-list":t._attachments,lazy:""}})})),1):t._e(),n("div",{staticClass:"u-toolbar"},[n("el-button",{staticClass:"u-admin",attrs:{type:"text",size:"mini",icon:"el-icon-chat-round"},on:{click:function(e){t.showForm=!t.showForm}}},[t._v("回复")]),t.canDelete?n("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.deleteComment()}}},[t._v("删除")]):t._e(),n("time",{staticClass:"u-date"},[n("i",{staticClass:"el-icon-time"}),t._v(" "+t._s(t.dataFormat(t.date))+" ")])],1),t.showForm?n("el-form",{ref:"form",staticClass:"c-comment-subbox",attrs:{model:t.newComment}},[n("el-form-item",[n("Emotion",{staticClass:"c-comment-emotion",on:{selected:t.handleEmotionSelected}}),n("el-input",{attrs:{type:"textarea",placeholder:"参与评论...",id:"id"+t.inputId},model:{value:t.newComment.content,callback:function(e){t.$set(t.newComment,"content",e)},expression:"newComment.content"}}),n("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-picture",size:"mini"},on:{click:function(e){t.showUploader=!t.showUploader}}},[t._v("图片")])],1),n("el-form-item",[t.showUploader?n("Uploader",{ref:"uploader",on:{onFinish:t.attachmentUploadFinish,onError:t.attachmentUplodError}}):t._e()],1),n("el-form-item",[n("el-button",{attrs:{size:"mini",type:"primary",disabled:t.disableSubmitBtn},on:{click:function(e){return t.submit()}}},[t._v("提交")]),n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.showForm=!1}}},[t._v("收起")])],1)],1):t._e()],1)},T=[],A=(n("d81d"),n("506c"));function Y(t){const e=new A["a"](t);return e.code}function N(t){return t>9?t:"0".concat(t)}var P={props:["content","date","hasReply","canDelete","attachments","commentId"],components:{Uploader:k,Emotion:M},data:function(){return{newComment:{content:""},showForm:!1,disableSubmitBtn:!1,showUploader:!1,inputId:""}},mounted:function(){this.commentId&&(this.inputId=this.commentId)},computed:{_attachments:function(){return this.attachments.map((function(t){return Object(o["resolveImagePath"])(t)}))}},methods:{deleteComment:function(){this.$emit("deteleComment")},dataFormat:function(t){var e=new Date(t);return e.getFullYear()+"-"+N(e.getMonth()+1)+"-"+N(e.getDate())+" "+N(e.getHours())+":"+N(e.getMinutes())+":"+N(e.getSeconds())},attachmentUploadFinish:function(t){this.disableSubmitBtn=!1,this.$emit("addNewReply",{content:this.newComment.content,attachmentList:t}),this.showUploader=!1,this.newComment={content:""}},attachmentUplodError:function(){this.disableSubmitBtn=!1},submit:function(){this.disableSubmitBtn=!0,this.$refs.uploader?this.$refs.uploader.upload():this.attachmentUploadFinish([])},hideForm:function(){},formatContent:Y,handleEmotionSelected:function(t){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function n(){var i,a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=document.querySelector("#id".concat(e.inputId)),console.log(i,t),!i.selectionStart&&0!==i.selectionStart){n.next=12;break}return a=i.selectionStart,o=i.selectionEnd,e.newComment.content=i.value.substring(0,a)+t+i.value.substring(o,i.value.length),n.next=8,e.$nextTick();case 8:i.focus(),i.setSelectionRange(o+t.length,o+t.length),n.next=13;break;case 12:e.newComment.content=t;case 13:case"end":return n.stop()}}),n)})))()}},filters:{showAttachment:function(t){return Object(o["resolveImagePath"])(t)+"?x-oss-process=style/comment_thumb"}}},H=P,B=(n("e314"),Object(d["a"])(H,U,T,!1,null,null,null)),z=B.exports,J=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.data.length?n("div",{staticClass:"c-comment-replylist"},[t._l(t.data,(function(e){return n("reply-item",{key:e.id,staticClass:"c-comment-reply",attrs:{reply:e,power:t.power},on:{deleteReply:t.deleteReply,addReply:t.addReply}})})),t.data.length>=3||t.showPager?n("el-row",[n("el-col",{attrs:{span:4}},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:t.showPager,expression:"showPager"}],attrs:{type:"text"},on:{click:function(e){return t.showLess()}}},[t._v("收起")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.showPager,expression:"!showPager"}],attrs:{type:"text"},on:{click:function(e){return t.showMore()}}},[t._v("查看更多")])],1),n("el-col",{staticClass:"c-comment-reply-pages",attrs:{span:20}},[n("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.showPager,expression:"showPager"}],attrs:{small:"","current-page":t.pager.index,"page-size":t.pager.pageSize,layout:"total, prev, pager, next",total:t.pager.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.pager,"index",e)},"update:current-page":function(e){return t.$set(t.pager,"index",e)}}})],1)],1):t._e()],2):t._e()},W=[],X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-row",[n("Avatar",{attrs:{"user-avatar":t._f("showAvatar")(t.reply.avatar),"user-href":t._f("profileLink")(t.reply.userId),username:t.reply.displayName}}),n("CommentContentSimple",{attrs:{"comment-id":t.reply.id,date:t.reply.commentDate,content:t.reply.content,attachments:t._f("stringToArray")(t.reply.attachments),"can-delete":t.power.allow||t.power.uid==t.reply.userId,"can-reply":t.power.uid!=t.reply.userId,"user-href":t._f("profileLink")(t.reply.replyForUID),"reply-for-username":t.reply.replyForUsername,"reply-for-user-id":t.reply.replyForUID},on:{delete:t.deleteReply,showReplyInput:function(e){t.showReplyForReplyFrom=!t.showReplyForReplyFrom}}}),t.showReplyForReplyFrom?n("ReplyForReply",{attrs:{username:t.reply.displayName,"user-href":t._f("profileLink")(t.reply.userId),"current-id":t.reply.id},on:{hideForm:function(e){t.showReplyForReplyFrom=!1},doReply:t.doReply}}):t._e()],1)},V=[],q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"u-reply"},[n("div",{staticClass:"u-reply-content"},[0!=t.replyForUserId?n("span",{staticClass:"u-reply-label"},[t._v(" 回复 "),n("el-link",{attrs:{type:"primary",target:"_blank",href:t.userHref}},[t._v("@"+t._s(t.replyForUsername))]),t._v(" : ")],1):t._e(),n("div",{staticClass:"u-reply-text",domProps:{innerHTML:t._s(t.formatContent(t.content))}})]),t.attachments.length?n("div",{staticClass:"u-attachements"},t._l(t.attachments,(function(e){return n("el-image",{key:e,attrs:{src:t._f("showAttachment")(e),"preview-src-list":t._attachments,lazy:""}})})),1):t._e(),n("div",{staticClass:"u-toolbar"},[t.canDelete?n("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.deleteComment()}}},[t._v("删除")]):t._e(),t.canReply?n("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-chat-line-round",size:"mini"},on:{click:function(e){return t.showReplyForReplyInput()}}},[t._v("回复")]):t._e(),n("time",{staticClass:"u-date"},[n("i",{staticClass:"el-icon-time"}),t._v(" "+t._s(t.dataFormat(t.date))+" ")])],1)])},Z=[];n("ac1f"),n("1276");function G(t){return t>9?t:"0".concat(t)}var Q={props:["commentId","content","attachments","date","hasReply","canDelete","canReply","userHref","replyForUsername","replyForUserId"],data:function(){return{showInput:!1}},computed:{_attachments:function(){return this.attachments.map((function(t){return Object(o["resolveImagePath"])(t)}))}},filters:{profileLink:function(t){return Object(o["authorLink"])(t)},showAttachment:function(t){return Object(o["resolveImagePath"])(t)+"?x-oss-process=style/comment_thumb"}},methods:{formatContent:Y,getPList:function(t){return t.split("\n")},deleteComment:function(){this.$emit("delete",this.commentId)},dataFormat:function(t){var e=new Date(t);return e.getFullYear()+"-"+G(e.getMonth()+1)+"-"+G(e.getDate())+" "+G(e.getHours())+":"+G(e.getMinutes())+":"+G(e.getSeconds())},showReplyForReplyInput:function(){this.$emit("showReplyInput")}}},K=Q,tt=(n("0b4e"),Object(d["a"])(K,q,Z,!1,null,null,null)),et=tt.exports,nt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-form",{ref:"form",staticClass:"c-comment-subbox"},[n("div",{staticClass:"u-subbox-label"},[t._v(" 回复 "),n("el-link",{attrs:{type:"primary",target:"_blank",href:t.userHref}},[t._v("＠"+t._s(t.username))]),t._v(" ： ")],1),n("el-form-item",[n("Emotion",{staticClass:"c-comment-emotion",on:{selected:t.handleEmotionSelected}}),n("el-input",{attrs:{type:"textarea",id:"id"+t.inputId},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),n("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-picture",size:"mini"},on:{click:function(e){t.showUploader=!t.showUploader}}},[t._v("图片")])],1),n("el-form-item",[t.showUploader?n("Uploader",{ref:"uploader",on:{onFinish:t.attachmentUploadFinish,onError:t.attachmentUplodError}}):t._e()],1),n("el-form-item",[n("el-button",{attrs:{size:"mini",type:"primary",disabled:t.disableSubmitBtn},on:{click:function(e){return t.submintReply()}}},[t._v("提交")]),n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.hideForm()}}},[t._v("收起")])],1)],1)},it=[],at={props:["username","userHref","currentId"],data:function(){return{content:"",showUploader:!1,disableSubmitBtn:!1,inputId:""}},components:{Uploader:k,Emotion:M},mounted:function(){this.currentId&&(this.inputId=this.currentId)},methods:{submintReply:function(){this.disableSubmitBtn=!0,this.$refs.uploader?this.$refs.uploader.upload():this.attachmentUploadFinish([])},hideForm:function(){this.$emit("hideForm")},attachmentUploadFinish:function(t){this.disableSubmitBtn=!1,this.$emit("doReply",{content:this.content,attachmentList:t}),this.content="",this.showUploader=!1},attachmentUplodError:function(){this.disableSubmitBtn=!1},handleEmotionSelected:function(t){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function n(){var i,a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=document.querySelector("#id".concat(e.inputId)),console.log(i,t),!i.selectionStart&&0!==i.selectionStart){n.next=12;break}return a=i.selectionStart,o=i.selectionEnd,e.content=i.value.substring(0,a)+t+i.value.substring(o,i.value.length),n.next=8,e.$nextTick();case 8:i.focus(),i.setSelectionRange(o+t.length,o+t.length),n.next=13;break;case 12:e.content=t;case 13:case"end":return n.stop()}}),n)})))()}}},ot=at,st=(n("0837"),Object(d["a"])(ot,nt,it,!1,null,null,null)),rt=st.exports,ct={props:["reply","power"],components:{Avatar:h,CommentContentSimple:et,ReplyForReply:rt},backReplyList:[],data:function(){return{showReplyForReplyFrom:!1}},filters:{profileLink:function(t){return Object(o["authorLink"])(t)},stringToArray:function(t){return t?JSON.parse(t):[]},showAvatar:function(t){return Object(o["showAvatar"])(t,28)}},methods:{deleteReply:function(t){this.$emit("deleteReply",t)},doReply:function(t){t.replyForUID=this.reply.userId,t.replyForCommentId=this.reply.id,this.$emit("addReply",t),this.showReplyForReplyFrom=!1}}},lt=ct,ut=Object(d["a"])(lt,X,V,!1,null,null,null),dt=ut.exports,mt={props:["data","power","pager"],components:{ReplyItem:dt},data:function(){return{showPager:!1}},filters:{profileLink:function(t){return Object(o["authorLink"])(t)}},methods:{showMore:function(){this.showPager=!0,this.$emit("goto",1)},showLess:function(){this.showPager=!1,this.$emit("resetReply")},handleCurrentChange:function(t){this.$emit("goto",t)},deleteReply:function(t){this.$emit("deleteReply",t)},addReply:function(t){this.$emit("addNewReply",t)}}},ht=mt,ft=(n("8366"),Object(d["a"])(ht,J,W,!1,null,null,null)),pt=ft.exports,gt=n("ee8f"),yt=n("5c96");const vt=function(t,e){let n={method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}};return kt(t,e,n)};var bt={};const _t=function(t,e,n){if(bt[t])if(Date.now()-bt[t].lastest<6e4){if(bt[t].count>=6)return yt["Notification"].warning({title:"系统",message:"你单身多久了? 动作这么快, 系统处理不过来 ( T_T )",duration:3e3,position:"bottom-right"}),new Promise((t,e)=>{e()});bt[t].count=bt[t].count+1}else Date.now()-bt[t].lastest>6e4&&(bt[t]={lastest:Date.now(),count:0});else bt[t]={lastest:Date.now(),count:0};let i={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)};return kt(t,e,i)},wt=function(t,e){let n={method:"DELETE"};return kt(t,e,n)};function kt(t,e,n){let i="https://next2.jx3box.com/";if("/"==i[i.length-1]&&(i=i.substring(0,i.length-1)),t=i+t,n.credentials="include",e){let n=[];Object.keys(e).forEach(t=>{n.push(t+"="+e[t])});let i="https://next2.jx3box.com/";"/"==i[i.length-1]&&(i=i.substring(0,i.length-1)),t=t+"?"+n.join("&")}return fetch(t,n).then(t=>{switch(t.status){case 200:break;case 401:throw window.location.href=gt["JX3BOX"].__Links.account.login+"?redirect="+encodeURIComponent(window.location.href),new Error("错误:"+t.statusText);case 403:throw window.location.href=gt["JX3BOX"].__Links.account.login+"?redirect="+encodeURIComponent(window.location.href),new Error("错误:"+t.statusText);case 423:throw window.location.href=gt["JX3BOX"].__Links.account.email_verify+"?redirect="+encodeURIComponent(window.location.href),new Error("错误:"+t.statusText);case 406:throw t.text().then(t=>{yt["Notification"].warning({title:"系统",message:t||"提交内容不合法,请重新提交",duration:3e3,position:"bottom-right"})}),new Error("错误:"+t.statusText);default:throw t.text().then(e=>{yt["Notification"].error({title:"系统:"+t.statusText,message:e||"系统错误,请稍后重试!",duration:3e3,position:"bottom-right"})}),new Error("错误:"+t.statusText)}let e=t.headers.get("Content-Type");switch(e=e&&e.split(";").shift(),e){case"application/json":return t.json();default:return t.text()}})}var Ct={props:["item","baseApi","power","user-href","username"],components:{CommentContent:z,ReplyList:pt},data:function(){return{replyList:[],pager:{index:1,pageSize:10,pageTotal:1,total:0}}},filters:{stringToArray:function(t){return t?JSON.parse(t):[]}},created:function(){this.replyList=this.item.reply||[]},methods:{deteleComment:function(){this.$emit("deteleComment",this.item.id)},addNewReply:function(t){var e=this;_t("".concat(this.baseApi,"/comment/").concat(this.item.id,"/reply"),null,t).then((function(){e.$notify({title:"",message:"评论成功!",type:"success",duration:3e3,position:"bottom-right"}),e.loadReplyList(e.pager.index)})).catch((function(){}))},deleteReply:function(t){var e=this;wt("".concat(this.baseApi,"/comment/").concat(t)).then((function(){e.$notify({title:"",message:"删除成功!",type:"success",duration:3e3,position:"bottom-right"}),e.loadReplyList(e.pager.index)})).catch((function(){}))},gotoReplyListIndex:function(t){this.loadReplyList(t,6)},loadReplyList:function(t,e){var n=this;vt("".concat(this.baseApi,"/comment/").concat(this.item.id,"/reply/page/").concat(t,"?pageSize=").concat(e)).then((function(i){1==t&&3==e&&(n.item.reply=i.data||[]),n.replyList=i.data||[],n.pager=i.page})).catch((function(){}))},resetReply:function(){this.loadReplyList(1,3)}}},$t=Ct,xt=Object(d["a"])($t,E,F,!1,null,null,null),jt=xt.exports,St=n("bc3a"),Lt=n.n(St),Mt=n("41cb"),It=n("c9d2");const Ot="commentDefaultOrderMode";async function Rt(){return It["a"].isLogin()?Object(Mt["b"])().get("/api/cms/user/my/meta",{params:{key:Ot}}).then(t=>t.data.data):new Promise(t=>{t(localStorage.getItem(Ot))})}async function Dt(t){return It["a"].isLogin()?Object(Mt["b"])().post("/api/cms/user/my/meta",{val:t},{params:{key:Ot}}).then(t=>t.data.data):new Promise(e=>{e(localStorage.setItem(Ot,t))})}var Et={name:"Comment",props:["id","category","normal","order"],components:{Avatar:h,CommmentWithReply:jt,CommentInputForm:D},data:function(){return{baseAPI:"",commentPower:{allow:!1,uid:-1},commentList:[],pager:{index:1,pageSize:10,pageTotal:1,total:0},isDesc:"desc"==this.order,loading:!1}},computed:{isNormal:function(){return void 0===this.normal||this.normal}},methods:{changeOrder:function(){this.reloadCommentList(this.pager.index),Dt(this.isDesc?"desc":"asc")},deteleComment:function(t){var e=this;wt("".concat(this.baseAPI,"/comment/").concat(t)).then((function(){e.$notify({title:"",message:"删除成功!",type:"success",duration:3e3,position:"bottom-right"}),e.reloadCommentList(e.pager.index)})).catch((function(){}))},reloadCommentList:function(t){var e=this;this.loading=!0;var n={};this.isDesc&&(n["desc"]=!0),vt("".concat(this.baseAPI,"/comment/page/").concat(t),n).then((function(t){e.commentList=t.data||[],e.pager=t.page})).catch((function(){})).finally((function(){e.loading=!1}))},handleCurrentChange:function(t){this.reloadCommentList(t)},userSubmitInputForm:function(t){var e=this;_t("".concat(this.baseAPI,"/comment"),null,t).then((function(){e.$notify({title:"",message:"评论成功!",type:"success",duration:3e3,position:"bottom-right"}),1==e.pager.index&&e.reloadCommentList(e.pager.index)})).catch((function(){}))},loadFrames:function(){var t=this;Lt.a.get(c["__imgPath"]+"data/user_avatar_frame.json").then((function(e){e.data&&(t.$store.state.frames=e.data)}))}},filters:{profileLink:function(t){return Object(o["authorLink"])(t)},showAvatar:function(t){return Object(o["showAvatar"])(t,48)}},created:function(){this.baseAPI="/api/comment/".concat(this.category,"/article/").concat(this.id)},mounted:function(){var t=this;Rt().then((function(e){t.isDesc="desc"==e})).then((function(){t.reloadCommentList(1),t.loadFrames(),vt("".concat(t.baseAPI,"/i-am-author")).then((function(e){t.commentPower=e})).catch((function(){}))}))}},Ft=Et,Ut=(n("ae14"),Object(d["a"])(Ft,i,a,!1,null,null,null));e["a"]=Ut.exports},"33a5":function(t){t.exports=JSON.parse('{"0":"江湖","1":"天策","2":"万花","3":"纯阳","4":"七秀","5":"少林","6":"藏剑","7":"丐帮","8":"明教","9":"五毒","10":"唐门","18":"苍云","19":"长歌","20":"霸刀","21":"蓬莱","22":"凌雪","23":"衍天"}')},4208:function(t,e,n){!function(e,n){t.exports=n()}(0,(function(){"use strict";return function(t,e,n){t=t||{};var i=e.prototype,a={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function o(t,e,n,a){return i.fromToBase(t,e,n,a)}n.en.relativeTime=a,i.fromToBase=function(e,i,o,s,r){for(var c,l,u,d=o.$locale().relativeTime||a,m=t.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],h=m.length,f=0;f<h;f+=1){var p=m[f];p.d&&(c=s?n(e).diff(o,p.d,!0):o.diff(e,p.d,!0));var g=(t.rounding||Math.round)(Math.abs(c));if(u=c>0,g<=p.r||!p.r){g<=1&&f>0&&(p=m[f-1]);var y=d[p.l];r&&(g=r(""+g)),l="string"==typeof y?y.replace("%d",g):y(g,i,p.l,u);break}}if(i)return l;var v=u?d.future:d.past;return"function"==typeof v?v(l):v.replace("%s",l)},i.to=function(t,e){return o(t,e,this,!0)},i.from=function(t,e){return o(t,e,this)};var s=function(t){return t.$u?n.utc():n()};i.toNow=function(t){return this.to(s(this),t)},i.fromNow=function(t){return this.from(s(this),t)}}}))},"506c":function(t,e,n){"use strict";var i=n("1157"),a=n.n(i),o=n("e9a5"),s=n("65c2");class r{constructor(t){this._joke=a.a.trim(t),this.init()}init(){this.code=this._renderHTML()}_renderHTML(){let t=this._joke;const e=Object.keys(o),n=/(#[\u4e00-\u9fa5]{1})/g,i=/(#[\u4e00-\u9fa5]{2})/g,a=/(#[\u4e00-\u9fa5]{3})/g,r=t=>{const e=Object.keys(t),n={};return e.forEach(t=>{const e=t.slice(1),i=s["__imgPath"]+`image/emotion/${e}.gif`;n[t]=i}),n},c=t=>{let e=r(o);return`<img src="${e[t]}" />`},l=t.match(n)?t.match(n).filter(t=>e.includes(t)):[];l.forEach(e=>t=t.replace(e,c));const u=t.match(i)?t.match(i).filter(t=>e.includes(t)):[];u.forEach(e=>t=t.replace(e,c));const d=t.match(a)?t.match(a).filter(t=>e.includes(t)):[];return d.forEach(e=>t=t.replace(e,c)),t}}e["a"]=r},"5a0c":function(t,e,n){!function(e,n){t.exports=n()}(0,(function(){"use strict";var t=1e3,e=6e4,n=36e5,i="millisecond",a="second",o="minute",s="hour",r="day",c="week",l="month",u="quarter",d="year",m="date",h="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},y=function(t,e,n){var i=String(t);return!i||i.length>=e?t:""+Array(e+1-i.length).join(n)+t},v={s:y,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),i=Math.floor(n/60),a=n%60;return(e<=0?"+":"-")+y(i,2,"0")+":"+y(a,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var i=12*(n.year()-e.year())+(n.month()-e.month()),a=e.clone().add(i,l),o=n-a<0,s=e.clone().add(i+(o?-1:1),l);return+(-(i+(n-a)/(o?a-s:s-a))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:l,y:d,w:c,d:r,D:m,h:s,m:o,s:a,ms:i,Q:u}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},b="en",_={};_[b]=g;var w=function(t){return t instanceof x},k=function(t,e,n){var i;if(!t)return b;if("string"==typeof t)_[t]&&(i=t),e&&(_[t]=e,i=t);else{var a=t.name;_[a]=t,i=a}return!n&&i&&(b=i),i||!n&&b},C=function(t,e){if(w(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new x(n)},$=v;$.l=k,$.i=w,$.w=function(t,e){return C(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var x=function(){function g(t){this.$L=k(t.locale,null,!0),this.parse(t)}var y=g.prototype;return y.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if($.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var i=e.match(f);if(i){var a=i[2]-1||0,o=(i[7]||"0").substring(0,3);return n?new Date(Date.UTC(i[1],a,i[3]||1,i[4]||0,i[5]||0,i[6]||0,o)):new Date(i[1],a,i[3]||1,i[4]||0,i[5]||0,i[6]||0,o)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},y.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},y.$utils=function(){return $},y.isValid=function(){return!(this.$d.toString()===h)},y.isSame=function(t,e){var n=C(t);return this.startOf(e)<=n&&n<=this.endOf(e)},y.isAfter=function(t,e){return C(t)<this.startOf(e)},y.isBefore=function(t,e){return this.endOf(e)<C(t)},y.$g=function(t,e,n){return $.u(t)?this[e]:this.set(n,t)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(t,e){var n=this,i=!!$.u(e)||e,u=$.p(t),h=function(t,e){var a=$.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return i?a:a.endOf(r)},f=function(t,e){return $.w(n.toDate()[t].apply(n.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},p=this.$W,g=this.$M,y=this.$D,v="set"+(this.$u?"UTC":"");switch(u){case d:return i?h(1,0):h(31,11);case l:return i?h(1,g):h(0,g+1);case c:var b=this.$locale().weekStart||0,_=(p<b?p+7:p)-b;return h(i?y-_:y+(6-_),g);case r:case m:return f(v+"Hours",0);case s:return f(v+"Minutes",1);case o:return f(v+"Seconds",2);case a:return f(v+"Milliseconds",3);default:return this.clone()}},y.endOf=function(t){return this.startOf(t,!1)},y.$set=function(t,e){var n,c=$.p(t),u="set"+(this.$u?"UTC":""),h=(n={},n[r]=u+"Date",n[m]=u+"Date",n[l]=u+"Month",n[d]=u+"FullYear",n[s]=u+"Hours",n[o]=u+"Minutes",n[a]=u+"Seconds",n[i]=u+"Milliseconds",n)[c],f=c===r?this.$D+(e-this.$W):e;if(c===l||c===d){var p=this.clone().set(m,1);p.$d[h](f),p.init(),this.$d=p.set(m,Math.min(this.$D,p.daysInMonth())).$d}else h&&this.$d[h](f);return this.init(),this},y.set=function(t,e){return this.clone().$set(t,e)},y.get=function(t){return this[$.p(t)]()},y.add=function(i,u){var m,h=this;i=Number(i);var f=$.p(u),p=function(t){var e=C(h);return $.w(e.date(e.date()+Math.round(t*i)),h)};if(f===l)return this.set(l,this.$M+i);if(f===d)return this.set(d,this.$y+i);if(f===r)return p(1);if(f===c)return p(7);var g=(m={},m[o]=e,m[s]=n,m[a]=t,m)[f]||1,y=this.$d.getTime()+i*g;return $.w(y,this)},y.subtract=function(t,e){return this.add(-1*t,e)},y.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||h;var i=t||"YYYY-MM-DDTHH:mm:ssZ",a=$.z(this),o=this.$H,s=this.$m,r=this.$M,c=n.weekdays,l=n.months,u=function(t,n,a,o){return t&&(t[n]||t(e,i))||a[n].substr(0,o)},d=function(t){return $.s(o%12||12,t,"0")},m=n.meridiem||function(t,e,n){var i=t<12?"AM":"PM";return n?i.toLowerCase():i},f={YY:String(this.$y).slice(-2),YYYY:this.$y,M:r+1,MM:$.s(r+1,2,"0"),MMM:u(n.monthsShort,r,l,3),MMMM:u(l,r),D:this.$D,DD:$.s(this.$D,2,"0"),d:String(this.$W),dd:u(n.weekdaysMin,this.$W,c,2),ddd:u(n.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(o),HH:$.s(o,2,"0"),h:d(1),hh:d(2),a:m(o,s,!0),A:m(o,s,!1),m:String(s),mm:$.s(s,2,"0"),s:String(this.$s),ss:$.s(this.$s,2,"0"),SSS:$.s(this.$ms,3,"0"),Z:a};return i.replace(p,(function(t,e){return e||f[t]||a.replace(":","")}))},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(i,m,h){var f,p=$.p(m),g=C(i),y=(g.utcOffset()-this.utcOffset())*e,v=this-g,b=$.m(this,g);return b=(f={},f[d]=b/12,f[l]=b,f[u]=b/3,f[c]=(v-y)/6048e5,f[r]=(v-y)/864e5,f[s]=v/n,f[o]=v/e,f[a]=v/t,f)[p]||v,h?b:$.a(b)},y.daysInMonth=function(){return this.endOf(l).$D},y.$locale=function(){return _[this.$L]},y.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),i=k(t,e,!0);return i&&(n.$L=i),n},y.clone=function(){return $.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},g}(),j=x.prototype;return C.prototype=j,[["$ms",i],["$s",a],["$m",o],["$H",s],["$W",r],["$M",l],["$y",d],["$D",m]].forEach((function(t){j[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),C.extend=function(t,e){return t.$i||(t(e,x,C),t.$i=!0),C},C.locale=k,C.isDayjs=w,C.unix=function(t){return C(1e3*t)},C.en=_[b],C.Ls=_,C.p={},C}))},"5ca7":function(t,e,n){},"818b":function(t){t.exports=JSON.parse('{"title":" &raquo; 魔盒（JX3BOX） - 一站式剑网3资源工具站","keys":"jx3box,剑三魔盒,剑三宏,剑三插件,剑三辅助,副本攻略,副本解包,团队监控,捏脸数据,剑3数据库,成就百科,剑三成就,剑3,剑网3,剑三box,通识百科","desc":"JX3BOX - 剑三魔盒是一个以剑网3游戏为主的专业攻略资源站，这里干货满满，大神多多，为你的武侠江湖之路助力。剑三魔盒，玩家贴心的小助手。"}')},8366:function(t,e,n){"use strict";n("b07e")},"976f":function(t,e,n){"use strict";n("5ca7")},a471:function(t,e,n){!function(e,i){t.exports=i(n("5a0c"))}(0,(function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=e(t),i={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(t,e){switch(e){case"W":return t+"周";default:return t+"日"}},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(t,e){var n=100*t+e;return n<600?"凌晨":n<900?"早上":n<1100?"上午":n<1300?"中午":n<1800?"下午":"晚上"}};return n.default.locale(i,null,!0),i}))},ae14:function(t,e,n){"use strict";n("c2ee")},b07e:function(t,e,n){},b64b:function(t,e,n){var i=n("23e7"),a=n("7b0b"),o=n("df75"),s=n("d039"),r=s((function(){o(1)}));i({target:"Object",stat:!0,forced:r},{keys:function(t){return o(a(t))}})},b9c7:function(t,e,n){},c0ba:function(t,e,n){"use strict";n("084d")},c2ee:function(t,e,n){},d81d:function(t,e,n){"use strict";var i=n("23e7"),a=n("b727").map,o=n("1dde"),s=o("map");i({target:"Array",proto:!0,forced:!s},{map:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},e314:function(t,e,n){"use strict";n("f263")},e7d2:function(t,e,n){},e9a5:function(t){t.exports=JSON.parse('{"#下雨":"下雨.gif","#严寒":"严寒.gif","#亲亲":"亲亲.gif","#傲慢":"傲慢.gif","#冷汗":"冷汗.gif","#凶恶":"凶恶.gif","#刀":"刀.gif","#发怒":"发怒.gif","#口水":"口水.gif","#可怜":"可怜.gif","#吐":"吐.gif","#吓":"吓.gif","#呆":"呆.gif","#呲牙":"呲牙.gif","#咖啡":"咖啡.gif","#唇":"唇.gif","#喜欢":"喜欢.gif","#嘴":"嘴.gif","#噢":"噢.gif","#困":"困.gif","#大笑":"大笑.gif","#太阳":"太阳.gif","#媚眼":"媚眼.gif","#害羞":"害羞.gif","#寒":"寒.gif","#尴尬":"尴尬.gif","#差劲":"差劲.gif","#巴掌":"巴掌.gif","#强":"强.gif","#得意":"得意.gif","#微笑":"微笑.gif","#心碎":"心碎.gif","#恐慌":"恐慌.gif","#恶心":"恶心.gif","#感叹号":"感叹号.gif","#扁嘴":"扁嘴.gif","#打雷":"打雷.gif","#拍手":"拍手.gif","#握手":"握手.gif","#撇嘴":"撇嘴.gif","#无奈":"无奈.gif","#昏":"昏.gif","#晕":"晕.gif","#月亮":"月亮.gif","#标记":"标记.gif","#樱桃":"樱桃.gif","#欣喜":"欣喜.gif","#沉默":"沉默.gif","#流汗":"流汗.gif","#流泪":"流泪.gif","#灯泡":"灯泡.gif","#烟花":"烟花.gif","#爱心":"爱心.gif","#狂汗":"狂汗.gif","#狡猾":"狡猾.gif","#狡诈":"狡诈.gif","#猪":"猪.gif","#玫瑰":"玫瑰.gif","#生气":"生气.gif","#电话":"电话.gif","#睡":"睡.gif","#礼物":"礼物.gif","#笨猪":"笨猪.gif","#第一名":"第一名.gif","#第三名":"第三名.gif","#第二名":"第二名.gif","#红灯":"红灯.gif","#绿灯":"绿灯.gif","#胜利":"胜利.gif","#舌头":"舌头.gif","#色":"色.gif","#花":"花.gif","#苹果":"苹果.gif","#菠萝":"菠萝.gif","#蒜头":"蒜头.gif","#蜡烛":"蜡烛.gif","#衰":"衰.gif","#西瓜":"西瓜.gif","#讨厌":"讨厌.gif","#讶异":"讶异.gif","#鄙视":"鄙视.gif","#酷":"酷.gif","#钱":"钱.gif","#锤子":"锤子.gif","#问号":"问号.gif","#阴险":"阴险.gif","#难过":"难过.gif","#雪糕":"雪糕.gif","#饮料":"饮料.gif","#馒头":"馒头.gif","#香蕉":"香蕉.gif","#骷髅":"骷髅.gif","#鬼脸":"鬼脸.gif","#黄灯":"黄灯.gif"}')},ecfb:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"v-joke"},[t.id?n("div",{staticClass:"m-joke-single-container"},[n("div",{staticClass:"m-joke-goback"},[n("el-button",{attrs:{size:"mini",icon:"el-icon-arrow-left"},on:{click:t.goBack}},[t._v("返回列表")]),t._m(0)],1),n("el-row",{staticClass:"v-joke-list",attrs:{gutter:20}},[n("el-col",{staticClass:"item",attrs:{span:24}},[n("div",{staticClass:"v-joke-list-item"},[n("joke-item",{attrs:{joke:t.joke,mode:"single"}})],1)])],1),t.joke.tags&&t.joke.tags.length?n("div",{staticClass:"m-joke-tags"},[n("i",{staticClass:"el-icon-price-tag"}),t._l(t.joke.tags,(function(e,i){return n("span",{key:i,staticClass:"u-tag"},[t._v(t._s(e))])}))],2):t._e(),n("Thx",{staticClass:"m-thx",attrs:{postId:t.id,postType:"joke",userId:t.user_id,adminBoxcoinEnable:!1,userBoxcoinEnable:!0}}),n("div",{staticClass:"m-single-comment"},[n("el-divider",{attrs:{"content-position":"left"}},[t._v("评论")]),t.id&&!t.joke.comment?n("Comment",{attrs:{id:t.id,category:"post"}}):n("el-alert",{attrs:{title:"作者没有开启评论功能",type:"warning","show-icon":""}})],1)],1):n("div",{staticClass:"m-joke-list-container"},[n("div",{staticClass:"m-joke-search",attrs:{slot:"search-before"},slot:"search-before"},[n("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[n("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("关键词")]),n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),n("div",{staticClass:"m-joke-types"},[n("el-tabs",{model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[n("el-tab-pane",{attrs:{name:"all",label:"全部"}}),t._l(t.schoolmap,(function(e,i){return n("el-tab-pane",{key:i,attrs:{name:i}},[n("div",{staticStyle:{"min-width":"57px"},attrs:{slot:"label"},slot:"label"},[n("img",{staticClass:"u-icon",attrs:{src:t._f("showSchoolIcon")(i),alt:e}}),t._v(" "+t._s(e)+" ")])])}))],2)],1),t.jokes&&t.jokes.length?n("el-row",{staticClass:"v-joke-list",attrs:{gutter:20}},t._l(t.jokes,(function(e){return n("el-col",{key:e.ID,staticClass:"item",attrs:{span:24}},[n("div",{staticClass:"v-joke-list-item"},[n("joke-item",{attrs:{joke:e},on:{update:t.handleJokeUpdate}})],1)])})),1):n("el-alert",{attrs:{title:"没有找到相关条目",type:"info","show-icon":""}}),n("el-pagination",{staticClass:"v-joke-pagination",attrs:{background:"","page-size":t.per,"hide-on-single-page":!0,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.total},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.skipTop}})],1)])},a=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a",{staticClass:"u-doc",attrs:{href:"/tool/23239",target:"_blank"}},[n("i",{staticClass:"el-icon-info"}),t._v("游戏内获取或发布骚话 ")])}],o=(n("ac1f"),n("841c"),n("b64b"),n("4e82"),n("159b"),n("d3b7"),n("65c2")),s=n("e9a5"),r=n("41cb"),c=function(t){var e=Object.assign(t,{type:"joke"});return Object(r["b"])().get("/api/cms/posts",{params:e})};function l(t){return Object(r["b"])().get("/api/cms/post/".concat(t))}var u=function(t){var e=t.id,n=t.data;return Object(r["b"])().put("/api/cms/post/".concat(e,"/setting"),n)},d=function(t){return Object(r["b"])().put("/api/cms/post/".concat(t,"/setting"),{post_status:"dustbin"})},m=function(t){return Object(r["b"])().get("/api/cms/user/".concat(t,"/info"))},h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"m-joke-item"},[n("div",{staticClass:"content"},[t.isEditor?n("i",{staticClass:"u-star-op",class:t.isMark?"on":"",on:{click:t.handleMark}},[t._v("★")]):n("i",{directives:[{name:"show",rawName:"v-show",value:t.isMark,expression:"isMark"}],staticClass:"u-star"},[t._v("★")]),n("span",{staticClass:"u-sentence",domProps:{innerHTML:t._s(t.parse(t.joke.post_title))}})]),n("div",{staticClass:"misc"},[n("div",{staticClass:"op"},[n("el-link",{staticClass:"copy-btn",attrs:{type:"primary",disabled:t.disabled},on:{click:function(e){return t.handleCopy(t.joke.post_title)}}},[n("i",{staticClass:"el-icon-document-copy"}),t._v(" "+t._s(t.copyLabel)+" ")]),"single"!==t.mode?n("router-link",{staticClass:"el-link el-link--primary is-underline copy-btn",attrs:{to:"/joke/"+t.joke.ID}},[n("i",{staticClass:"el-icon-chat-dot-square"}),t._v("评论 ")]):t._e(),"single"===t.mode?n("a",{staticClass:"u-edit el-link el-link--primary is-underline",attrs:{href:t.editLink("joke",t.joke.ID),target:"_blank"}},[n("i",{staticClass:"el-icon-edit-outline"}),t._v(" 编辑 ")]):t._e()],1),n("div",{staticClass:"u-other"},[n("div",{staticClass:"user"},[n("img",{attrs:{width:"24",height:"24",src:t._f("showAvatar")(t.authorAvatar)}}),t.joke.post_author&&1!=t.joke.post_author?n("a",{attrs:{href:t._f("authorLink")(t.joke.post_author),target:"_blank"}},[t._v(t._s(t.authorName))]):n("span",[t._v(t._s(t.authorName))])]),n("div",{staticClass:"u-time"},[n("span",{staticClass:"u-date"},[n("i",{staticClass:"el-icon-date"}),t._v("  "),n("time",[t._v(t._s(t._f("dateFormat")(t.joke.post_date)))])])])])]),n("i",{directives:[{name:"show",rawName:"v-show",value:t.isEditor,expression:"isEditor"}],staticClass:"el-icon-close u-joke-delete",attrs:{title:"删除"},on:{click:t.delJoke}})])},f=[],p=n("506c"),g=n("fb92"),y=n("85e4"),v=n("c9d2"),b={name:"joke_item",props:["joke","mode"],data:function(){return{copyLabel:"点击复制",disabled:!1,isMark:!1,authorInfo:null}},watch:{joke:{deep:!0,immediate:!0,handler:function(){var t,e,n;(this.isMark=!(null===(t=this.joke)||void 0===t||null===(e=t.mark)||void 0===e||!e.length),"single"===this.mode)&&(null!==(n=this.joke)&&void 0!==n&&n.post_author&&this.loadAuthor(this.joke.post_author))}}},filters:{dateFormat:function(t){return Object(g["a"])(new Date(t))},showAvatar:function(t){return Object(y["showAvatar"])(t,24)},authorLink:y["authorLink"]},computed:{isEditor:function(){return v["a"].isEditor()},authorName:function(){var t,e,n,i;return(null===(t=this.authorInfo)||void 0===t?void 0:t.display_name)||(null===(e=this.joke)||void 0===e||null===(n=e.author_info)||void 0===n?void 0:n.display_name)||(null===(i=this.joke)||void 0===i?void 0:i.author)||"匿名"},authorAvatar:function(){var t,e,n;return(null===(t=this.authorInfo)||void 0===t?void 0:t.user_avatar)||(null===(e=this.joke)||void 0===e||null===(n=e.author_info)||void 0===n?void 0:n.user_avatar)||""}},methods:{parse:function(t){var e=new p["a"](t);return e.code},handleCopy:function(t){var e=this;this.disabled=!0,navigator.clipboard.writeText(t).then((function(){e.copyLabel="已复制",setTimeout((function(){e.copyLabel="点击复制",e.disabled=!1}),3e3)}))},editLink:y["editLink"],handleMark:function(){var t=this,e=this.isMark?[]:["recommended"];u({id:this.joke.ID,data:{mark:e}}).then((function(){t.$notify({title:"成功",message:t.isMark?"取消加精成功":"加精成功",type:"success"}),t.isMark=!!e.length,t.$forceUpdate()})).catch((function(e){t.$notify({title:"错误",message:(null===e||void 0===e?void 0:e.message)||"设置失败，请重试或者联系管理员",type:"error"})}))},delJoke:function(){var t=this;this.$confirm("此操作将会删除该骚话，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){d(t.joke.ID).then((function(){t.$notify({title:"成功",message:"删除成功",type:"success"}),"single"===t.mode?t.$router.go(-1):t.$emit("update")})).catch((function(e){t.$notify({title:"错误",message:(null===e||void 0===e?void 0:e.message)||"删除失败，请重试或者联系管理员",type:"error"})}))}))},loadAuthor:function(t){var e=this;m(t).then((function(t){e.authorInfo=t.data.data}))}}},_=b,w=n("2877"),k=Object(w["a"])(_,h,f,!1,null,null,null),C=k.exports,$=n("33a5"),x=n("23d8"),j={name:"Joke",components:{"joke-item":C,Comment:x["a"]},data:function(){return{loading:!1,sortedEmotions:[],schoolmap:$,type:"all",search:"",per:10,page:1,total:1,jokes:[],joke:""}},computed:{id:function(){return this.$route.params.id},params:function(t){var e=t.search,n=t.page,i=t.per,a={per:i,page:n,order:"post_date-DESC"};return"all"!=this.type&&(a.subtype=this.type),e&&Object.assign(a,{search:e}),a},keys:function(){return[this.search,this.page,this.per,this.type,this.id]},user_id:function(){var t;return(null===(t=this.joke)||void 0===t?void 0:t.post_author)||0}},filters:{showSchoolIcon:function(t){return o["__imgPath"]+"image/school/"+t+".png"}},methods:{sortEmotion:function(){var t=this,e=Object.keys(s);e.sort((function(t,e){return t.localeCompare(e)})),e.forEach((function(e){var n={key:e,value:s[e]};t.sortedEmotions.push(n)}))},loadList:function(){var t=this;this.loading=!0,c(this.params).then((function(e){t.jokes=e.data.data.list,t.total=e.data.data.total})).catch((function(t){})).finally((function(){t.loading=!1}))},loadSingle:function(){var t=this;this.loading=!0,l(this.id).then((function(e){t.joke=e.data.data})).finally((function(){t.loading=!1}))},init:function(){this.id?this.loadSingle():this.loadList()},goBack:function(){this.$router.push("/joke")},handleJokeUpdate:function(){this.loadList()},skipTop:function(){window.scrollTo(0,0)}},watch:{keys:{handler:function(){this.init()},deep:!0,immediate:!0}},created:function(){this.sortEmotion()}},S=j,L=(n("976f"),Object(w["a"])(S,i,a,!1,null,null,null));e["default"]=L.exports},ee8f:function(t,e,n){const i=n("65c2"),a=n("818b");t.exports={JX3BOX:i,SEO:a}},f263:function(t,e,n){},f7729:function(t,e,n){"use strict";n("0886")},fb92:function(t,e,n){"use strict";n.d(e,"b",(function(){return r}));n("99af");var i=n("5a0c"),a=n.n(i),o=n("4208");function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.getFullYear(),a=t.getMonth()+1,o=t.getDate(),s=n?"".concat(i).concat(e).concat(c(a)).concat(e).concat(c(o)):"".concat(i).concat(e).concat(a).concat(e).concat(o);return s}function r(t){return a()().from(a()(t))}function c(t){return t<10?"0"+t:t}n("a471"),a.a.locale("zh-cn"),a.a.extend(o),e["a"]=s}}]);
//# sourceMappingURL=chunk-25b01d58.1fd88406.js.map