(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06eb1d32"],{"33a5":function(t){t.exports=JSON.parse('{"0":"江湖","1":"天策","2":"万花","3":"纯阳","4":"七秀","5":"少林","6":"藏剑","7":"丐帮","8":"明教","9":"五毒","10":"唐门","18":"苍云","19":"长歌","20":"霸刀","21":"蓬莱","22":"凌雪","23":"衍天","24":"药宗"}')},"5ca7":function(t,e,a){},"976f":function(t,e,a){"use strict";a("5ca7")},ecfb:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"v-joke"},[t.id?a("div",{staticClass:"m-joke-single-container"},[a("div",{staticClass:"m-joke-goback"},[a("el-button",{attrs:{size:"mini",icon:"el-icon-arrow-left"},on:{click:t.goBack}},[t._v("返回列表")]),t._m(0)],1),a("el-row",{staticClass:"v-joke-list",attrs:{gutter:20}},[a("el-col",{staticClass:"item",attrs:{span:24}},[a("div",{staticClass:"v-joke-list-item"},[a("joke-item",{attrs:{joke:t.joke,mode:"single"}})],1)])],1),t.joke.tags&&t.joke.tags.length?a("div",{staticClass:"m-joke-tags"},[a("i",{staticClass:"el-icon-price-tag"}),t._l(t.joke.tags,(function(e,i){return a("span",{key:i,staticClass:"u-tag"},[t._v(t._s(e))])}))],2):t._e(),a("Thx",{staticClass:"m-thx",attrs:{postId:t.id,postType:"joke",userId:t.user_id,adminBoxcoinEnable:!1,userBoxcoinEnable:!0}}),a("div",{staticClass:"m-single-comment"},[a("el-divider",{attrs:{"content-position":"left"}},[t._v("评论")]),t.id&&!t.joke.comment?a("Comment",{attrs:{id:t.id,category:"post"}}):a("el-alert",{attrs:{title:"作者没有开启评论功能",type:"warning","show-icon":""}})],1)],1):a("div",{staticClass:"m-joke-list-container"},[a("div",{staticClass:"m-joke-search",attrs:{slot:"search-before"},slot:"search-before"},[a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[a("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("关键词")]),a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),a("div",{staticClass:"m-joke-types"},[a("el-tabs",{model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[a("el-tab-pane",{attrs:{name:"all",label:"全部"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"u-icon el-icon-menu",staticStyle:{"vertical-align":"0"}}),t._v("全部 ")])]),t._l(t.schoolmap,(function(e,i){return a("el-tab-pane",{key:i,attrs:{name:i}},[a("div",{staticStyle:{"min-width":"57px"},attrs:{slot:"label"},slot:"label"},[a("img",{staticClass:"u-icon",attrs:{src:t._f("showSchoolIcon")(i),alt:e}}),t._v(" "+t._s(e)+" ")])])}))],2)],1),t.jokes&&t.jokes.length?a("el-row",{staticClass:"v-joke-list",attrs:{gutter:20}},t._l(t.jokes,(function(e){return a("el-col",{key:e.ID,staticClass:"item",attrs:{span:24}},[a("div",{staticClass:"v-joke-list-item"},[a("joke-item",{attrs:{joke:e},on:{update:t.handleJokeUpdate}})],1)])})),1):a("el-alert",{attrs:{title:"没有找到相关条目",type:"info","show-icon":""}}),a("el-pagination",{staticClass:"v-joke-pagination",attrs:{background:"","page-size":t.per,"hide-on-single-page":!0,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.total},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.skipTop}})],1)])},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a",{staticClass:"u-doc",attrs:{href:"/tool/23239",target:"_blank"}},[a("i",{staticClass:"el-icon-info"}),t._v("游戏内获取或发布骚话 ")])}],o=(a("ac1f"),a("841c"),a("b64b"),a("4e82"),a("d3b7"),a("159b"),a("d81d"),a("a15b"),a("65c2")),n=a("0608"),l=a("3a4b"),r=a("29c2"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-joke-item"},[a("div",{staticClass:"u-content",class:"single"===t.mode?"on":"",on:{click:t.handleContent}},[a("span",{staticClass:"u-sentence",domProps:{innerHTML:t._s(t.parse(t.joke.post_title))}})]),a("div",{staticClass:"misc"},[a("div",{staticClass:"op"},[a("span",{staticClass:"user"},[a("img",{attrs:{width:"24",height:"24",src:t._f("showAvatar")(t.authorAvatar)}}),t.joke.post_author&&1!=t.joke.post_author?a("a",{attrs:{href:t._f("authorLink")(t.joke.post_author),target:"_blank"}},[t._v(t._s(t.authorName))]):a("span",[t._v(t._s(t.authorName))])]),a("el-link",{staticClass:"copy-btn",attrs:{type:"primary",disabled:t.disabled},on:{click:function(e){return t.handleCopy(t.joke.post_title)}}},[a("i",{staticClass:"el-icon-document-copy"}),t._v(" "+t._s(t.copyLabel)+" ")]),"single"===t.mode?a("a",{staticClass:"u-edit el-link el-link--primary is-underline",attrs:{href:t.editLink("joke",t.joke.ID),target:"_blank"}},[a("i",{staticClass:"el-icon-edit-outline"}),t._v(" 编辑 ")]):t._e(),t.isListPage?a("a",{staticClass:"like",class:{disabled:!t.isLike,on:!t.isLike},attrs:{title:"赞"},on:{click:t.addLike}},[a("i",{staticClass:"like-icon"},[t._v(t._s(t.isLike?"♡":"♥"))]),t._v("Like "),t.count?a("span",{staticClass:"like-count"},[t._v(t._s(t.count))]):t._e()]):t._e()],1),a("div",{staticClass:"u-other"},[a("div",{staticClass:"u-time"},[t.isEditor?a("i",{staticClass:"u-star u-star-op",class:t.isMark?"on":"",on:{click:t.handleMark}},[t._v("★")]):t._e(),a("span",{staticClass:"u-date"},[a("i",{staticClass:"el-icon-date"}),t._v("  "),a("time",[t._v(t._s(t._f("dateFormat")(t.joke.post_date)))])])])])])])},u=[],d=a("506c"),h=a("fb92"),p=a("85e4"),k=a("c9d2"),f=a("9616"),v={name:"joke_item",props:["joke","mode"],data:function(){return{copyLabel:"复制",disabled:!1,isMark:!1,authorInfo:null,count:0,isLike:!0}},watch:{joke:{deep:!0,immediate:!0,handler:function(){var t,e,a,i;(this.isMark=!(null===(t=this.joke)||void 0===t||null===(e=t.mark)||void 0===e||!e.length),"single"===this.mode)&&(null!==(i=this.joke)&&void 0!==i&&i.post_author&&this.loadAuthor(this.joke.post_author));this.count=(null===(a=this.joke)||void 0===a?void 0:a.count)||0}}},filters:{dateFormat:function(t){return Object(h["a"])(new Date(t))},showAvatar:function(t){return Object(p["showAvatar"])(t,24)},authorLink:p["authorLink"]},computed:{isListPage:function(){return"single"!=this.mode},isEditor:function(){return k["a"].isEditor()},authorName:function(){var t,e,a,i;return(null===(t=this.authorInfo)||void 0===t?void 0:t.display_name)||(null===(e=this.joke)||void 0===e||null===(a=e.author_info)||void 0===a?void 0:a.display_name)||(null===(i=this.joke)||void 0===i?void 0:i.author)||"匿名"},authorAvatar:function(){var t,e,a;return(null===(t=this.authorInfo)||void 0===t?void 0:t.user_avatar)||(null===(e=this.joke)||void 0===e||null===(a=e.author_info)||void 0===a?void 0:a.user_avatar)||""}},methods:{addLike:function(){if(this.isLike){var t;if(this.count++,this.isLike)Object(f["b"])("joke",null===(t=this.joke)||void 0===t?void 0:t.ID,"likes");this.isLike=!1}},parse:function(t){var e=new d["a"](t);return e.code},handleCopy:function(t){var e=this;this.disabled=!0,navigator.clipboard.writeText(t).then((function(){e.copyLabel="已复制",setTimeout((function(){e.copyLabel="复制",e.disabled=!1}),3e3)}))},editLink:p["editLink"],handleMark:function(){var t=this,e=this.isMark?[]:["recommended"];Object(l["e"])({id:this.joke.ID,data:{mark:e}}).then((function(){t.$notify({title:"成功",message:t.isMark?"取消加精成功":"加精成功",type:"success"}),t.isMark=!!e.length,t.$forceUpdate()})).catch((function(e){t.$notify({title:"错误",message:(null===e||void 0===e?void 0:e.message)||"设置失败，请重试或者联系管理员",type:"error"})}))},delJoke:function(){var t=this;this.$confirm("此操作将会删除该骚话，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(l["d"])(t.joke.ID).then((function(){t.$notify({title:"成功",message:"删除成功",type:"success"}),"single"===t.mode?t.$router.go(-1):t.$emit("update")})).catch((function(e){t.$notify({title:"错误",message:(null===e||void 0===e?void 0:e.message)||"删除失败，请重试或者联系管理员",type:"error"})}))}))},loadAuthor:function(t){var e=this;Object(l["a"])(t).then((function(t){e.authorInfo=t.data.data}))},handleContent:function(){this.$router.push("/joke/".concat(this.joke.ID))}}},m=v,j=a("2877"),g=Object(j["a"])(m,c,u,!1,null,null,null),_=g.exports,b=a("33a5"),y=a("23d8"),C={name:"Joke",components:{"joke-item":_,Comment:y["a"]},data:function(){return{loading:!1,sortedEmotions:[],schoolmap:b,type:"all",search:"",per:10,page:1,total:1,jokes:[],joke:""}},computed:{id:function(){return this.$route.params.id},params:function(t){var e=t.search,a=t.page,i=t.per,s={per:i,page:a,order:"post_date-DESC"};return"all"!=this.type&&(s.subtype=this.type),e&&Object.assign(s,{search:e}),s},keys:function(){return[this.search,this.page,this.per,this.type,this.id]},user_id:function(){var t;return(null===(t=this.joke)||void 0===t?void 0:t.post_author)||0}},filters:{showSchoolIcon:function(t){return o["__imgPath"]+"image/school/"+t+".png"}},methods:{sortEmotion:function(){var t=this,e=Object.keys(n);e.sort((function(t,e){return t.localeCompare(e)})),e.forEach((function(e){var a={key:e,value:n[e]};t.sortedEmotions.push(a)}))},loadList:function(){var t=this;this.loading=!0,Object(l["c"])(this.params).then((function(e){t.jokes=e.data.data.list,t.total=e.data.data.total})).catch((function(t){})).finally((function(){t.loading=!1}))},loadSingle:function(){var t=this;this.loading=!0,Object(l["b"])(this.id).then((function(e){t.joke=e.data.data})).finally((function(){t.loading=!1}))},init:function(){this.id?this.loadSingle():this.loadList()},goBack:function(){this.$router.push("/joke")},handleJokeUpdate:function(){this.loadList()},skipTop:function(){window.scrollTo(0,0)},loadLike:function(){var t=this,e=this.jokes.map((function(t){return"joke-"+t.ID}));e=e.join(",");var a={post_type:"joke",post_action:"likes",id:"joke-"+e};Object(r["a"])(a).then((function(e){var a=e.data.data;Object.keys(a).length&&t.jokes.forEach((function(e){var i;t.$set(e,"count",null===a||void 0===a||null===(i=a["joke-"+e.ID])||void 0===i?void 0:i.likes)}))}))}},watch:{keys:{handler:function(){this.init()},deep:!0,immediate:!0},jokes:{deep:!0,handler:function(){this.loadLike()}}},created:function(){this.sortEmotion()}},w=C,L=(a("976f"),Object(j["a"])(w,i,s,!1,null,null,null));e["default"]=L.exports}}]);
//# sourceMappingURL=chunk-06eb1d32.0bbdb441.js.map