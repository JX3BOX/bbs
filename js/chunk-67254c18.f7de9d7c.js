(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-67254c18"],{"0de9":function(t,e,i){"use strict";i("57e8")},"1c05":function(t,e,i){"use strict";i("7efe")},"1ce6":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("CollectionLayout",{attrs:{"has-right":!1}},[i("div",{staticClass:"m-collection-single"},[t.collection?[i("div",{staticClass:"m-collection-detail-content"},[i("div",{staticClass:"m-collection-detail-header"},[i("header",{staticClass:"m-single-header"},[i("div",{staticClass:"m-single-title"},[i("span",{staticClass:"u-title u-sub-block",attrs:{href:t.url,title:t.collection.title}},[t.collection.public?t._e():i("i",{staticClass:"u-private el-icon-lock",attrs:{title:"仅自己可见"}}),i("span",{staticClass:"u-title-text"},[t._v(t._s(t.collection.title))])])]),i("div",{staticClass:"m-single-info"},[i("div",{staticClass:"u-author u-sub-block"},[i("i",{staticClass:"u-author-icon"},[i("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 16",width:"12",height:"16","aria-hidden":"true",fill:"#444","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[i("path",{attrs:{"fill-rule":"evenodd",d:"M12 14.002a.998.998 0 01-.998.998H1.001A1 1 0 010 13.999V13c0-2.633 4-4 4-4s.229-.409 0-1c-.841-.62-.944-1.59-1-4 .173-2.413 1.867-3 3-3s2.827.586 3 3c-.056 2.41-.159 3.38-1 4-.229.59 0 1 0 1s4 1.367 4 4v1.002z"}})])]),i("a",{staticClass:"u-name",attrs:{href:t._f("authorLink")(t.collection.user_id)}},[t._v(t._s(t.collection.collection_user_info&&t.collection.collection_user_info.display_name))])]),i("span",{staticClass:"u-podate u-sub-block",attrs:{title:"发布日期"}},[i("i",{staticClass:"u-icon el-icon-date"}),i("time",[t._v(t._s(t.dateFormat(t.collection.created)))])]),i("span",{staticClass:"u-modate u-sub-block",attrs:{title:"最后更新"}},[i("i",{staticClass:"u-icon el-icon-refresh"}),i("time",[t._v(t._s(t.dateFormat(t.collection.updated)))])]),i("span",{staticClass:"u-views u-sub-block"},[i("i",{staticClass:"u-icon el-icon-view"}),t._v(" "+t._s(t.views)+" ")]),t.canEdit?i("a",{staticClass:"u-edit u-sub-block",attrs:{href:t.edit_link}},[i("i",{staticClass:"u-icon-edit el-icon-edit-outline"}),i("span",[t._v("编辑")])]):t._e(),t.canEdit?i("a",{staticClass:"u-delete u-sub-block",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.delete_handle(e,t.collection.id)}}},[i("i",{staticClass:"u-icon-remove el-icon-delete"}),i("span",[t._v("删除")])]):t._e()])])]),t.collection.description?[i("el-divider",{attrs:{"content-position":"left"}},[i("i",{staticClass:"el-icon-collection"}),t._v(" 小册简介 ")]),i("div",{staticClass:"u-description"},[i("p",{domProps:{innerHTML:t._s(t.resolveImagePath(t.collection.description))}})])]:t._e(),t.collection.posts&&t.collection.posts.length?[i("el-divider",{attrs:{"content-position":"left"}},[i("i",{staticClass:"el-icon-folder"}),t._v(" 小册文章 ")]),i("ul",{staticClass:"u-list"},t._l(t.collection.posts,(function(e,n){return i("li",{key:n,staticClass:"u-item"},[i("span",{staticClass:"u-item-order"},[t._v(t._s(n+1)+".")]),"custom"===e.type?i("span",{staticClass:"u-item-link"},[i("i",{staticClass:"el-icon-link"}),t._v("站外链接 ")]):t._e(),"custom"!==e.type&&e.user_id?i("a",{staticClass:"u-item-author",attrs:{target:"_blank",href:t._f("authorLink")(e.user_id)}},[i("img",{staticClass:"u-avatar",attrs:{src:t.showAvatar(e.user_avatar)}}),i("span",{staticClass:"u-nickname",domProps:{textContent:t._s(e.user_nickname)}}),i("span",{staticClass:"u-div"},[t._v("/")])]):t._e(),i("a",{staticClass:"u-item-title",attrs:{target:"_blank",href:"custom"===e.type?e.url:t.getLink(e.post_type||e.type,e.id)}},[t._v(t._s(e.title))]),e.updated?i("time",{staticClass:"u-updated",domProps:{textContent:t._s("最后更新于 "+t.formatDate(e.updated))}}):t._e()])})),0)]:t._e()],2),i("Thx",{staticClass:"m-thx",attrs:{postId:t.id,postType:"collection",postTitle:t.title,userId:t.author_id,adminBoxcoinEnable:!0,userBoxcoinEnable:!0,client:"all"}}),t.id?i("div",{staticClass:"m-comments"},[i("el-divider",{attrs:{"content-position":"left"}},[i("span",{staticStyle:{color:"#999999"}},[i("i",{staticClass:"el-icon-chat-line-square"}),t._v(" 讨论 ")])]),i("jx3-comment",{attrs:{id:t.id,category:"collection"}})],1):t._e()]:i("el-alert",{attrs:{title:"该剑三小册不存在或已被删除",type:"info",center:"","show-icon":"",closable:!1}})],2)])},a=[],o=(i("d3b7"),i("23d8"));const s=Object.freeze({PRIVATE:0,PUBLIC:1,all(){return[this.PRIVATE,this.PUBLIC]}});var c=s,l=i("73cd"),r=i("fb92"),u=i("5a0c"),d=i.n(u),p=i("2b0e"),f=new p["default"],m=f,h=i("85e4"),_=i("c9d2"),v=i("9616"),b=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("Header"),i("Breadcrumb",{attrs:{name:"剑三小册",slug:"collection",root:"/collection",publishEnable:!0,adminEnable:!1,feedbackEnable:!0,crumbEnable:!0},scopedSlots:t._u([{key:"op-prepend",fn:function(){return[t.isEditor?i("el-button",{staticClass:"c-admin-button u-admin",attrs:{type:"primary",icon:"el-icon-setting"},on:{click:t.onAdminClick}},[t._v("管理")]):t._e()]},proxy:!0}])}),i("LeftSidebar",{attrs:{uid:t.user_id}},[i("Nav",{staticClass:"m-nav",attrs:{id:t.id}})],1),i("Main",{attrs:{withoutRight:!t.hasRight}},[t._t("default"),i("RightSidebar",[i("Side",{staticClass:"m-extend",attrs:{id:t.id}})],1),i("Footer")],2),i("CollectionAdmin",{model:{value:t.showDrawer,callback:function(e){t.showDrawer=e},expression:"showDrawer"}})],1)},C=[],g=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"m-single-nav"},[i("Author",{attrs:{uid:t.uid}})],1)},y=[],w={name:"single_nav",props:[],data:function(){return{}},computed:{uid:function(){return this.$store.state.user_id}},methods:{},mounted:function(){}},k=w,x=i("2877"),Y=Object(x["a"])(k,g,y,!1,null,null,null),D=Y.exports,L=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"m-single-side"},[t.id?i("PostTopic",{attrs:{type:"bps",id:~~t.id}}):t._e(),i("PostDirectory",{attrs:{id:"directory"}}),t.showSideCollection?i("PostCollection",{attrs:{store:t.collection_data}}):t._e()],1)},M=[],T=i("6370"),j=i("7221"),$=i("bf34"),O={name:"single_side",props:["id"],data:function(){return{}},components:{PostDirectory:T["a"],PostCollection:j["a"],PostTopic:$["a"]},computed:{hasDirectory:function(){var t;return null===(t=this.$store.state.extend)||void 0===t?void 0:t.directory},showSideCollection:function(){var t,e,i=null===(t=this.$store.state.post)||void 0===t?void 0:t.post_collection,n=!(null!==(e=this.$store.state.post)&&void 0!==e&&e.collection_collapse);return i&&n},collection_data:function(){var t;return null===(t=this.$store.state.extend)||void 0===t?void 0:t.collection_data}}},E=O,I=(i("b853"),Object(x["a"])(E,L,M,!1,null,null,null)),P=I.exports,S=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-drawer",{staticClass:"c-admin",attrs:{title:"管理面板",visible:t.modelValue,"before-close":t.close,"append-to-body":!0,modal:!1,withHeader:!1}},[i("div",{staticClass:"c-admin-wrapper"},[i("el-divider",{attrs:{"content-position":"left"}},[t._v("可见性变更")]),i("el-radio-group",{staticClass:"c-admin-status",attrs:{size:"small"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},t._l(t.visible_options,(function(e,n){return i("el-radio-button",{key:n,attrs:{label:n}},[t._v(t._s(e))])})),1),i("el-divider",{attrs:{"content-position":"left"}},[t._v("元信息")]),i("div",{staticClass:"c-admin-title"},[i("el-input",{staticClass:"input-author drawer-item-content",attrs:{placeholder:"请输入小册标题"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}},[i("template",{slot:"prepend"},[t._v("标题")])],2)],1),i("div",{staticClass:"c-admin-info"},[i("div",{staticClass:"c-admin-author"},[i("el-input",{staticClass:"input-author drawer-item-content",attrs:{placeholder:"请输入作者uid"},model:{value:t.post_author,callback:function(e){t.post_author=e},expression:"post_author"}},[i("template",{slot:"prepend"},[t._v("作者")])],2)],1)]),i("div",{staticClass:"c-admin-buttons"},[i("el-button",{attrs:{type:"primary",loading:t.pushing},on:{click:t.submit}},[t._v("提交")]),i("el-button",{attrs:{type:"plain"},on:{click:t.close}},[t._v("取消")])],1)],1)])},A=[],H=(i("a4d3"),i("e01a"),i("65c2")),B={name:"CollectionAdmin",props:{modelValue:{type:Boolean,default:!1}},model:{prop:"modelValue",event:"update:modelValue"},data:function(){return{type_options:[],post_author:"",visible:1,title:"",pushing:!1,data:{}}},computed:{visible_options:function(){return{0:"私有",1:"公开"}},id:function(){return this.$route.params.id}},watch:{modelValue:function(t){t&&this.loadCollection()}},mounted:function(){this.initTypeOptions()},methods:{close:function(){this.$emit("update:modelValue",!1)},initTypeOptions:function(){var t=[];for(var e in H["__postType"])t.push({value:e,label:H["__postType"][e]});this.type_options=t},loadCollection:function(){var t=this;Object(l["a"])(this.id).then((function(e){t.data=e.data.data,t.post_author=t.data.user_id,t.visible=t.data.public,t.title=t.data.title}))},submit:function(){var t=this;this.pushing=!0,Object(l["e"])(this.id,{mark:this.data.mark,description:this.data.description,posts:JSON.stringify(this.data.posts),image:this.data.image,public:this.visible,user_id:~~this.post_author,title:this.title}).then((function(){t.$message({message:"更新成功",type:"success"}),m.$emit("updateCollection")})).finally((function(){t.pushing=!1}))}}},V=B,N=(i("b4ff"),Object(x["a"])(V,S,A,!1,null,null,null)),R=N.exports,z={name:"CollectionLayout",props:{hasRight:{type:Boolean,default:!0}},data:function(){return{id:Object(h["getAppID"])(),showDrawer:!1}},computed:{user_id:function(){return this.$store.state.user_id},isEditor:function(){return _["a"].isEditor()}},methods:{onAdminClick:function(){this.showDrawer=!0}},components:{Nav:D,Side:P,CollectionAdmin:R}},F=z,J=(i("0de9"),Object(x["a"])(F,b,C,!1,null,null,null)),U=J.exports,q={name:"CollectionSingle",props:[],components:{"jx3-comment":o["a"],CollectionLayout:U},data:function(){return{collection:"",publish:c,url:location.href,views:0,loading:!1}},computed:{edit_link:function(){return Object(h["editLink"])("collection",this.collection.id)},id:function(){var t;return null===(t=this.collection)||void 0===t?void 0:t.id},author_id:function(){var t;return(null===(t=this.collection)||void 0===t?void 0:t.user_id)||0},canEdit:function(){return this.author_id==_["a"].getInfo().uid||_["a"].isEditor()},title:function(){return this.collection.title}},watch:{"$route.params.id":{immediate:!0,handler:function(t){t&&(this.loadData(t),this.execStat(t))}}},methods:{getThumbnail:h["getThumbnail"],getLink:function(t,e){return Object(h["getLink"])(t,e)},getTypeLabel:h["getTypeLabel"],showAvatar:h["showAvatar"],resolveImagePath:h["resolveImagePath"],dateFormat:function(t){return Object(r["a"])(new Date(1e3*t))},delete_handle:function(t,e){var i=this;t.preventDefault(),this.$confirm("确认是否删除该剑三小册？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(l["d"])(e).then((function(t){i.$message.success("删除成功"),i.$router.push({name:"collection"})}))}))},loadData:function(t){var e=this;this.loading=!0,Object(l["a"])(t).then((function(t){var i;e.collection=(null===t||void 0===t||null===(i=t.data)||void 0===i?void 0:i.data)||{},e.$store.state.user_id=e.collection.user_id})).finally((function(){e.loading=!1}))},execStat:function(t){var e=this;Object(v["b"])("collection",t),Object(v["a"])("collection",t).then((function(t){e.views=t.data.views||0}))},formatDate:function(t){return console.log(t),d()(t).format("YYYY-MM-DD HH:mm:ss")}},filters:{authorLink:h["authorLink"]},created:function(){},mounted:function(){m.$on("updateCollection",(function(){location.reload()}))}},W=q,G=(i("baea"),Object(x["a"])(W,n,a,!1,null,null,null));e["default"]=G.exports},3262:function(t,e,i){},4208:function(t,e,i){!function(e,i){t.exports=i()}(0,(function(){"use strict";return function(t,e,i){t=t||{};var n=e.prototype,a={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function o(t,e,i,a){return n.fromToBase(t,e,i,a)}i.en.relativeTime=a,n.fromToBase=function(e,n,o,s,c){for(var l,r,u,d=o.$locale().relativeTime||a,p=t.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],f=p.length,m=0;m<f;m+=1){var h=p[m];h.d&&(l=s?i(e).diff(o,h.d,!0):o.diff(e,h.d,!0));var _=(t.rounding||Math.round)(Math.abs(l));if(u=l>0,_<=h.r||!h.r){_<=1&&m>0&&(h=p[m-1]);var v=d[h.l];c&&(_=c(""+_)),r="string"==typeof v?v.replace("%d",_):v(_,n,h.l,u);break}}if(n)return r;var b=u?d.future:d.past;return"function"==typeof b?b(r):b.replace("%s",r)},n.to=function(t,e){return o(t,e,this,!0)},n.from=function(t,e){return o(t,e,this)};var s=function(t){return t.$u?i.utc():i()};n.toNow=function(t){return this.to(s(this),t)},n.fromNow=function(t){return this.from(s(this),t)}}}))},"4c6c":function(t,e,i){"use strict";i("96ad")},"57e8":function(t,e,i){},6370:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"m-single-directory"})},a=[],o={name:"PostDirectory",props:[],components:{},data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){}},s=o,c=(i("1c05"),i("2877")),l=Object(c["a"])(s,n,a,!1,null,null,null);e["a"]=l.exports},7221:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.list&&t.list.length?i("div",{staticClass:"m-single-collection"},[t._m(0),i("ul",{staticClass:"u-list"},t._l(t.list,(function(e,n){return i("li",{key:n},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.title,placement:"left"}},[i("a",{attrs:{href:t.showLink(e),target:"_blank"}},[i("i",{staticClass:"el-icon-link"}),t._v(" "+t._s(e.title)+" ")])])],1)})),0)]):t._e()},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"u-title"},[i("i",{staticClass:"el-icon-connection"}),t._v(" 关联")])}],o=i("85e4"),s=i("1509"),c={name:"PostCollection",props:["id","store"],components:{},data:function(){return{data:{title:"",posts:[]}}},computed:{list:function(){var t,e;return(null===(t=this.store)||void 0===t?void 0:t.posts)||(null===(e=this.data)||void 0===e?void 0:e.posts)}},watch:{id:{immediate:!0,handler:function(t){~~t&&this.loadData()}}},methods:{loadData:function(){var t=this;Object(s["b"])(this.id).then((function(e){var i;t.data=null===(i=e.data)||void 0===i?void 0:i.data}))},showLink:function(t){return"custom"==t.type?t.url:Object(o["getLink"])(t.type,t.id)}}},l=c,r=(i("4c6c"),i("2877")),u=Object(r["a"])(l,n,a,!1,null,"b2ee5ea2",null);e["a"]=u.exports},"7efe":function(t,e,i){},"96ad":function(t,e,i){},"9ec6":function(t,e,i){"use strict";i("3262")},a471:function(t,e,i){!function(e,n){t.exports=n(i("5a0c"))}(0,(function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var i=e(t),n={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(t,e){return"W"===e?t+"周":t+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(t,e){var i=100*t+e;return i<600?"凌晨":i<900?"早上":i<1100?"上午":i<1300?"中午":i<1800?"下午":"晚上"}};return i.default.locale(n,null,!0),n}))},a5de:function(t,e,i){t.exports=i.p+"img/topic_bg_bps.423bd2a8.svg"},b21e:function(t,e,i){},b4ff:function(t,e,i){"use strict";i("f30c")},b853:function(t,e,i){"use strict";i("b21e")},baea:function(t,e,i){"use strict";i("c77d")},bf34:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.topicInfo,expression:"topicInfo"}],staticClass:"c-post-topic"},[n("div",{staticClass:"c-post-topic__banner"},[n("div",{staticClass:"c-topic-text"},[n("div",{staticClass:"c-topic-text__year"},[t._v(t._s(t.year))]),n("div",{staticClass:"c-topic-text__text"},[t._v(t._s(t.topicText))])]),n("img",{staticClass:"c-topic-bg",attrs:{src:i("a5de"),alt:""}})]),n("div",{staticClass:"c-post-topic__img"},[n("img",{attrs:{src:t.topicImage,alt:""}})])])},a=[],o=(i("a9e3"),i("caad"),i("2532"),i("1509")),s=i("85e4"),c=i("5a0c"),l=i.n(c),r={name:"PostTopic",props:{type:{type:String,default:"bps"},id:{type:Number,default:46917}},data:function(){return{topicInfo:null}},computed:{topicText:function(){return this.topicInfo?"".concat(l()(this.topicInfo.created_at).format("MM月DD日"),"荣登头条榜"):""},year:function(){return this.topicInfo?l()(this.topicInfo.created_at).format("YYYY年"):""},topicImage:function(){return this.topicInfo?Object(s["getThumbnail"])(this.topicInfo.img,[520,156]):""},client:function(){return location.href.includes("origin")?"origin":"std"}},watch:{id:{immediate:!0,handler:function(t){t&&this.loadData()}}},methods:{loadData:function(){var t=this;Object(o["f"])(this.type,this.id,this.client).then((function(e){var i;if(null!==(i=e.data.data)&&void 0!==i&&i.list){var n=e.data.data.list.sort((function(t,e){return l()(e.created_at).isAfter(l()(t.created_at))?1:-1}));t.topicInfo=n[0]}}))}}},u=r,d=(i("9ec6"),i("2877")),p=Object(d["a"])(u,n,a,!1,null,"77164ca4",null);e["a"]=p.exports},c77d:function(t,e,i){},f30c:function(t,e,i){},fb92:function(t,e,i){"use strict";i.d(e,"a",(function(){return c})),i.d(e,"b",(function(){return s}));i("99af");var n=i("5a0c"),a=i.n(n),o=i("4208");function s(t){return a()().from(a()(t))}function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t.getFullYear(),a=t.getMonth()+1,o=t.getDate(),s=i?"".concat(n).concat(e).concat(l(a)).concat(e).concat(l(o)):"".concat(n).concat(e).concat(a).concat(e).concat(o);return s}function l(t){return t<10?"0"+t:t}i("a471"),a.a.locale("zh-cn"),a.a.extend(o)}}]);
//# sourceMappingURL=chunk-67254c18.f7de9d7c.js.map